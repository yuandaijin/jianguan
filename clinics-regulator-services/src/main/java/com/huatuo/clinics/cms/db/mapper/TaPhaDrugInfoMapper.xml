<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.huatuo.clinics.cms.db.mapper.TaPhaDrugInfoMapper" >
  <resultMap id="BaseResultMap" type="com.huatuo.clinics.cms.db.bean.TaPhaDrugInfo" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Fri Aug 12 20:03:22 CST 2016.
    -->
    <id column="pha_drug_id" property="phaDrugId" jdbcType="CHAR" />
    <result column="drug_trade_id" property="drugTradeId" jdbcType="CHAR" />
    <result column="org_id" property="orgId" jdbcType="CHAR" />
    <result column="pharmacy_id" property="pharmacyId" jdbcType="CHAR" />
    <result column="trade_name" property="tradeName" jdbcType="VARCHAR" />
    <result column="drug_spec" property="drugSpec" jdbcType="VARCHAR" />
    <result column="comm_name" property="commName" jdbcType="VARCHAR" />
    <result column="dose_form" property="doseForm" jdbcType="VARCHAR" />
    <result column="spell_code" property="spellCode" jdbcType="VARCHAR" />
    <result column="wb_code" property="wbCode" jdbcType="VARCHAR" />
    <result column="t_spell_code" property="tSpellCode" jdbcType="VARCHAR" />
    <result column="t_wb_code" property="tWbCode" jdbcType="VARCHAR" />
    <result column="alias_name" property="aliasName" jdbcType="VARCHAR" />
    <result column="component" property="component" jdbcType="VARCHAR" />
    <result column="drug_type" property="drugType" jdbcType="VARCHAR" />
    <result column="drug_sub_type" property="drugSubType" jdbcType="VARCHAR" />
    <result column="suit" property="suit" jdbcType="VARCHAR" />
    <result column="pha_effect" property="phaEffect" jdbcType="VARCHAR" />
    <result column="tox_class" property="toxClass" jdbcType="VARCHAR" />
    <result column="physics_trait" property="physicsTrait" jdbcType="VARCHAR" />
    <result column="otc_type" property="otcType" jdbcType="VARCHAR" />
    <result column="med_type" property="medType" jdbcType="VARCHAR" />
    <result column="volume" property="volume" jdbcType="DECIMAL" />
    <result column="vol_unit" property="volUnit" jdbcType="VARCHAR" />
    <result column="weight" property="weight" jdbcType="DECIMAL" />
    <result column="weight_unit" property="weightUnit" jdbcType="VARCHAR" />
    <result column="concentration" property="concentration" jdbcType="DECIMAL" />
    <result column="def_freq" property="defFreq" jdbcType="VARCHAR" />
    <result column="def_dose_qty" property="defDoseQty" jdbcType="DECIMAL" />
    <result column="def_dose_unit" property="defDoseUnit" jdbcType="VARCHAR" />
    <result column="def_route" property="defRoute" jdbcType="VARCHAR" />
    <result column="bar_code" property="barCode" jdbcType="VARCHAR" />
    <result column="manufacturer" property="manufacturer" jdbcType="VARCHAR" />
    <result column="ncmc_flg" property="ncmcFlg" jdbcType="VARCHAR" />
    <result column="approval" property="approval" jdbcType="VARCHAR" />
    <result column="base_drug_flg" property="baseDrugFlg" jdbcType="VARCHAR" />
    <result column="kick_back" property="kickBack" jdbcType="VARCHAR" />
    <result column="tabu" property="tabu" jdbcType="VARCHAR" />
    <result column="matters" property="matters" jdbcType="VARCHAR" />
    <result column="valid_flg" property="validFlg" jdbcType="VARCHAR" />
    <result column="min_unit" property="minUnit" jdbcType="VARCHAR" />
    <result column="pack_unit" property="packUnit" jdbcType="VARCHAR" />
    <result column="conv_qty" property="convQty" jdbcType="INTEGER" />
    <result column="pack_retail_price" property="packRetailPrice" jdbcType="REAL" />
    <result column="min_retail_price" property="minRetailPrice" jdbcType="REAL" />
    <result column="stock_max" property="stockMax" jdbcType="INTEGER" />
    <result column="stock_min" property="stockMin" jdbcType="INTEGER" />
    <result column="wholesale_price" property="wholesalePrice" jdbcType="REAL" />
    <result column="bill_code" property="billCode" jdbcType="VARCHAR" />
    <result column="virtual_pack_qty" property="virtualPackQty" jdbcType="INTEGER" />
    <result column="virtual_min_qty" property="virtualMinQty" jdbcType="INTEGER" />
  </resultMap>
  <resultMap id="zdyStocktake" type="com.huatuo.clinics.cms.db.bean.ZdyStocktake" >
    <id column="pha_drug_id" property="phaDrugId" jdbcType="OTHER" />
    <result column="drug_trade_id" property="drugTradeId" jdbcType="OTHER" />
    <result column="org_id" property="orgId" jdbcType="OTHER" />
    <result column="pharmacy_id" property="pharmacyId" jdbcType="OTHER" />
    <result column="trade_name" property="tradeName" jdbcType="OTHER" />
    <result column="drug_spec" property="drugSpec" jdbcType="OTHER" />
    <result column="comm_name" property="commName" jdbcType="OTHER" />
    <result column="dose_form" property="doseForm" jdbcType="OTHER" />
    <result column="alias_name" property="aliasName" jdbcType="OTHER" />
    <result column="component" property="component" jdbcType="OTHER" />
    <result column="drug_type" property="drugType" jdbcType="OTHER" />
    <result column="drug_sub_type" property="drugSubType" jdbcType="OTHER" />
    <result column="suit" property="suit" jdbcType="OTHER" />
    <result column="pha_effect" property="phaEffect" jdbcType="OTHER" />
    <result column="tox_class" property="toxClass" jdbcType="OTHER" />
    <result column="physics_trait" property="physicsTrait" jdbcType="OTHER" />
    <result column="otc_type" property="otcType" jdbcType="OTHER" />
    <result column="med_type" property="medType" jdbcType="OTHER" />
    <result column="volume" property="volume" jdbcType="OTHER" />
    <result column="vol_unit" property="volUnit" jdbcType="OTHER" />
    <result column="weight" property="weight" jdbcType="OTHER" />
    <result column="weight_unit" property="weightUnit" jdbcType="OTHER" />
    <result column="concentration" property="concentration" jdbcType="OTHER" />
    <result column="def_freq" property="defFreq" jdbcType="OTHER" />
    <result column="def_dose_qty" property="defDoseQty" jdbcType="OTHER" />
    <result column="def_dose_unit" property="defDoseUnit" jdbcType="OTHER" />
    <result column="def_route" property="defRoute" jdbcType="OTHER" />
    <result column="bar_code" property="barCode" jdbcType="OTHER" />
    <result column="manufacturer" property="manufacturer" jdbcType="OTHER" />
    <result column="ncmc_flg" property="ncmcFlg" jdbcType="OTHER" />
    <result column="approval" property="approval" jdbcType="OTHER" />
    <result column="base_drug_flg" property="baseDrugFlg" jdbcType="OTHER" />
    <result column="kick_back" property="kickBack" jdbcType="OTHER" />
    <result column="tabu" property="tabu" jdbcType="OTHER" />
    <result column="matters" property="matters" jdbcType="OTHER" />
    <result column="valid_flg" property="validFlg" jdbcType="OTHER" />
    <result column="min_unit" property="minUnit" jdbcType="OTHER" />
    <result column="pack_unit" property="packUnit" jdbcType="OTHER" />
    <result column="conv_qty" property="convQty" jdbcType="OTHER" />
    <result column="pack_retail_price" property="packRetailPrice" jdbcType="OTHER" />
    <result column="min_retail_price" property="minRetailPrice" jdbcType="OTHER" />
    <result column="stock_max" property="stockMax" jdbcType="OTHER" />
    <result column="stock_min" property="stockMin" jdbcType="OTHER" />
    <result column="wholesale_price" property="wholesalePrice" jdbcType="OTHER" />
    <result column="bill_code" jdbcType="VARCHAR" property="billCode" />
    
    <result column="item_no" property="itemNo" jdbcType="OTHER" />
    <result column="pack_qty" property="packQty" jdbcType="OTHER" />
    <result column="pack_real_qty" property="packRealQty" jdbcType="OTHER" />
    <result column="min_qty" property="minQty" jdbcType="OTHER" />
    <result column="min_real_qty" property="minRealQty" jdbcType="OTHER" />
    <result column="instock_batch" property="instockBatch" jdbcType="OTHER" />
  </resultMap>
  <sql id="Example_Where_Clause" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Fri Aug 12 20:03:22 CST 2016.
    -->
    <where >
      <foreach collection="oredCriteria" item="criteria" separator="or" >
        <if test="criteria.valid" >
          <trim prefix="(" suffix=")" prefixOverrides="and" >
            <foreach collection="criteria.criteria" item="criterion" >
              <choose >
                <when test="criterion.noValue" >
                  and ${criterion.condition}
                </when>
                <when test="criterion.singleValue" >
                  and ${criterion.condition} #{criterion.value}
                </when>
                <when test="criterion.betweenValue" >
                  and ${criterion.condition} #{criterion.value} and #{criterion.secondValue}
                </when>
                <when test="criterion.listValue" >
                  and ${criterion.condition}
                  <foreach collection="criterion.value" item="listItem" open="(" close=")" separator="," >
                    #{listItem}
                  </foreach>
                </when>
              </choose>
            </foreach>
          </trim>
        </if>
      </foreach>
    </where>
  </sql>
  <sql id="Update_By_Example_Where_Clause" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Fri Aug 12 20:03:22 CST 2016.
    -->
    <where >
      <foreach collection="example.oredCriteria" item="criteria" separator="or" >
        <if test="criteria.valid" >
          <trim prefix="(" suffix=")" prefixOverrides="and" >
            <foreach collection="criteria.criteria" item="criterion" >
              <choose >
                <when test="criterion.noValue" >
                  and ${criterion.condition}
                </when>
                <when test="criterion.singleValue" >
                  and ${criterion.condition} #{criterion.value}
                </when>
                <when test="criterion.betweenValue" >
                  and ${criterion.condition} #{criterion.value} and #{criterion.secondValue}
                </when>
                <when test="criterion.listValue" >
                  and ${criterion.condition}
                  <foreach collection="criterion.value" item="listItem" open="(" close=")" separator="," >
                    #{listItem}
                  </foreach>
                </when>
              </choose>
            </foreach>
          </trim>
        </if>
      </foreach>
    </where>
  </sql>
  <sql id="Base_Column_List" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Fri Aug 12 20:03:22 CST 2016.
    -->
    pha_drug_id, drug_trade_id, org_id, pharmacy_id, trade_name, drug_spec, comm_name, 
    dose_form, spell_code, wb_code, t_spell_code, t_wb_code, alias_name, component, drug_type, 
    drug_sub_type, suit, pha_effect, tox_class, physics_trait, otc_type, med_type, volume, 
    vol_unit, weight, weight_unit, concentration, def_freq, def_dose_qty, def_dose_unit, 
    def_route, bar_code, manufacturer, ncmc_flg, approval, base_drug_flg, kick_back, 
    tabu, matters, valid_flg, min_unit, pack_unit, conv_qty, pack_retail_price, min_retail_price, 
    stock_max, stock_min, wholesale_price, bill_code, virtual_pack_qty, virtual_min_qty
  </sql>
  <select id="selectByExample" resultMap="BaseResultMap" parameterType="com.huatuo.clinics.cms.db.bean.TaPhaDrugInfoExample" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Fri Aug 12 20:03:22 CST 2016.
    -->
    select
    <if test="distinct" >
      distinct
    </if>
    <include refid="Base_Column_List" />
    from ta_pha_drug_info
    <if test="_parameter != null" >
      <include refid="Example_Where_Clause" />
    </if>
    <if test="orderByClause != null" >
      order by ${orderByClause}
    </if>
  </select>
  <select id="selectByPrimaryKey" resultMap="BaseResultMap" parameterType="java.lang.String" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Fri Aug 12 20:03:22 CST 2016.
    -->
    select 
    <include refid="Base_Column_List" />
    from ta_pha_drug_info
    where pha_drug_id = #{phaDrugId,jdbcType=CHAR}
  </select>
  <delete id="deleteByPrimaryKey" parameterType="java.lang.String" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Fri Aug 12 20:03:22 CST 2016.
    -->
    delete from ta_pha_drug_info
    where pha_drug_id = #{phaDrugId,jdbcType=CHAR}
  </delete>
  <delete id="deleteByExample" parameterType="com.huatuo.clinics.cms.db.bean.TaPhaDrugInfoExample" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Fri Aug 12 20:03:22 CST 2016.
    -->
    delete from ta_pha_drug_info
    <if test="_parameter != null" >
      <include refid="Example_Where_Clause" />
    </if>
  </delete>
  <insert id="insert" parameterType="com.huatuo.clinics.cms.db.bean.TaPhaDrugInfo" >
   <selectKey keyProperty="phaDrugId" resultType="String" order="BEFORE">  
        select  replace(uuid(),'-','')  from dual  
    </selectKey> 
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Fri Aug 12 20:03:22 CST 2016.
    -->
    insert into ta_pha_drug_info (pha_drug_id, drug_trade_id, org_id, 
      pharmacy_id, trade_name, drug_spec, 
      comm_name, dose_form, spell_code, 
      wb_code, t_spell_code, t_wb_code, 
      alias_name, component, drug_type, 
      drug_sub_type, suit, pha_effect, 
      tox_class, physics_trait, otc_type, 
      med_type, volume, vol_unit, 
      weight, weight_unit, concentration, 
      def_freq, def_dose_qty, def_dose_unit, 
      def_route, bar_code, manufacturer, 
      ncmc_flg, approval, base_drug_flg, 
      kick_back, tabu, matters, 
      valid_flg, min_unit, pack_unit, 
      conv_qty, pack_retail_price, min_retail_price, 
      stock_max, stock_min, wholesale_price, 
      bill_code, virtual_pack_qty, virtual_min_qty
      )
    values (uuid(), #{drugTradeId,jdbcType=CHAR}, #{orgId,jdbcType=CHAR}, 
      #{pharmacyId,jdbcType=CHAR}, #{tradeName,jdbcType=VARCHAR}, #{drugSpec,jdbcType=VARCHAR}, 
      #{commName,jdbcType=VARCHAR}, #{doseForm,jdbcType=VARCHAR}, #{spellCode,jdbcType=VARCHAR}, 
      #{wbCode,jdbcType=VARCHAR}, #{tSpellCode,jdbcType=VARCHAR}, #{tWbCode,jdbcType=VARCHAR}, 
      #{aliasName,jdbcType=VARCHAR}, #{component,jdbcType=VARCHAR}, #{drugType,jdbcType=VARCHAR}, 
      #{drugSubType,jdbcType=VARCHAR}, #{suit,jdbcType=VARCHAR}, #{phaEffect,jdbcType=VARCHAR}, 
      #{toxClass,jdbcType=VARCHAR}, #{physicsTrait,jdbcType=VARCHAR}, #{otcType,jdbcType=VARCHAR}, 
      #{medType,jdbcType=VARCHAR}, #{volume,jdbcType=DECIMAL}, #{volUnit,jdbcType=VARCHAR}, 
      #{weight,jdbcType=DECIMAL}, #{weightUnit,jdbcType=VARCHAR}, #{concentration,jdbcType=DECIMAL}, 
      #{defFreq,jdbcType=VARCHAR}, #{defDoseQty,jdbcType=DECIMAL}, #{defDoseUnit,jdbcType=VARCHAR}, 
      #{defRoute,jdbcType=VARCHAR}, #{barCode,jdbcType=VARCHAR}, #{manufacturer,jdbcType=VARCHAR}, 
      #{ncmcFlg,jdbcType=VARCHAR}, #{approval,jdbcType=VARCHAR}, #{baseDrugFlg,jdbcType=VARCHAR}, 
      #{kickBack,jdbcType=VARCHAR}, #{tabu,jdbcType=VARCHAR}, #{matters,jdbcType=VARCHAR}, 
      #{validFlg,jdbcType=VARCHAR}, #{minUnit,jdbcType=VARCHAR}, #{packUnit,jdbcType=VARCHAR}, 
      #{convQty,jdbcType=INTEGER}, #{packRetailPrice,jdbcType=REAL}, #{minRetailPrice,jdbcType=REAL}, 
      #{stockMax,jdbcType=INTEGER}, #{stockMin,jdbcType=INTEGER}, #{wholesalePrice,jdbcType=REAL}, 
      #{billCode,jdbcType=VARCHAR}, #{virtualPackQty,jdbcType=INTEGER}, #{virtualMinQty,jdbcType=INTEGER}
      )
  </insert>
  <insert id="insertSelective" parameterType="com.huatuo.clinics.cms.db.bean.TaPhaDrugInfo" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Fri Aug 12 20:03:22 CST 2016.
    -->
    insert into ta_pha_drug_info
    <trim prefix="(" suffix=")" suffixOverrides="," >
      <if test="phaDrugId != null" >
        pha_drug_id,
      </if>
      <if test="drugTradeId != null" >
        drug_trade_id,
      </if>
      <if test="orgId != null" >
        org_id,
      </if>
      <if test="pharmacyId != null" >
        pharmacy_id,
      </if>
      <if test="tradeName != null" >
        trade_name,
      </if>
      <if test="drugSpec != null" >
        drug_spec,
      </if>
      <if test="commName != null" >
        comm_name,
      </if>
      <if test="doseForm != null" >
        dose_form,
      </if>
      <if test="spellCode != null" >
        spell_code,
      </if>
      <if test="wbCode != null" >
        wb_code,
      </if>
      <if test="tSpellCode != null" >
        t_spell_code,
      </if>
      <if test="tWbCode != null" >
        t_wb_code,
      </if>
      <if test="aliasName != null" >
        alias_name,
      </if>
      <if test="component != null" >
        component,
      </if>
      <if test="drugType != null" >
        drug_type,
      </if>
      <if test="drugSubType != null" >
        drug_sub_type,
      </if>
      <if test="suit != null" >
        suit,
      </if>
      <if test="phaEffect != null" >
        pha_effect,
      </if>
      <if test="toxClass != null" >
        tox_class,
      </if>
      <if test="physicsTrait != null" >
        physics_trait,
      </if>
      <if test="otcType != null" >
        otc_type,
      </if>
      <if test="medType != null" >
        med_type,
      </if>
      <if test="volume != null" >
        volume,
      </if>
      <if test="volUnit != null" >
        vol_unit,
      </if>
      <if test="weight != null" >
        weight,
      </if>
      <if test="weightUnit != null" >
        weight_unit,
      </if>
      <if test="concentration != null" >
        concentration,
      </if>
      <if test="defFreq != null" >
        def_freq,
      </if>
      <if test="defDoseQty != null" >
        def_dose_qty,
      </if>
      <if test="defDoseUnit != null" >
        def_dose_unit,
      </if>
      <if test="defRoute != null" >
        def_route,
      </if>
      <if test="barCode != null" >
        bar_code,
      </if>
      <if test="manufacturer != null" >
        manufacturer,
      </if>
      <if test="ncmcFlg != null" >
        ncmc_flg,
      </if>
      <if test="approval != null" >
        approval,
      </if>
      <if test="baseDrugFlg != null" >
        base_drug_flg,
      </if>
      <if test="kickBack != null" >
        kick_back,
      </if>
      <if test="tabu != null" >
        tabu,
      </if>
      <if test="matters != null" >
        matters,
      </if>
      <if test="validFlg != null" >
        valid_flg,
      </if>
      <if test="minUnit != null" >
        min_unit,
      </if>
      <if test="packUnit != null" >
        pack_unit,
      </if>
      <if test="convQty != null" >
        conv_qty,
      </if>
      <if test="packRetailPrice != null" >
        pack_retail_price,
      </if>
      <if test="minRetailPrice != null" >
        min_retail_price,
      </if>
      <if test="stockMax != null" >
        stock_max,
      </if>
      <if test="stockMin != null" >
        stock_min,
      </if>
      <if test="wholesalePrice != null" >
        wholesale_price,
      </if>
      <if test="billCode != null" >
        bill_code,
      </if>
      <if test="virtualPackQty != null" >
        virtual_pack_qty,
      </if>
      <if test="virtualMinQty != null" >
        virtual_min_qty,
      </if>
    </trim>
    <trim prefix="values (" suffix=")" suffixOverrides="," >
      <if test="phaDrugId != null" >
        #{phaDrugId,jdbcType=CHAR},
      </if>
      <if test="drugTradeId != null" >
        #{drugTradeId,jdbcType=CHAR},
      </if>
      <if test="orgId != null" >
        #{orgId,jdbcType=CHAR},
      </if>
      <if test="pharmacyId != null" >
        #{pharmacyId,jdbcType=CHAR},
      </if>
      <if test="tradeName != null" >
        #{tradeName,jdbcType=VARCHAR},
      </if>
      <if test="drugSpec != null" >
        #{drugSpec,jdbcType=VARCHAR},
      </if>
      <if test="commName != null" >
        #{commName,jdbcType=VARCHAR},
      </if>
      <if test="doseForm != null" >
        #{doseForm,jdbcType=VARCHAR},
      </if>
      <if test="spellCode != null" >
        #{spellCode,jdbcType=VARCHAR},
      </if>
      <if test="wbCode != null" >
        #{wbCode,jdbcType=VARCHAR},
      </if>
      <if test="tSpellCode != null" >
        #{tSpellCode,jdbcType=VARCHAR},
      </if>
      <if test="tWbCode != null" >
        #{tWbCode,jdbcType=VARCHAR},
      </if>
      <if test="aliasName != null" >
        #{aliasName,jdbcType=VARCHAR},
      </if>
      <if test="component != null" >
        #{component,jdbcType=VARCHAR},
      </if>
      <if test="drugType != null" >
        #{drugType,jdbcType=VARCHAR},
      </if>
      <if test="drugSubType != null" >
        #{drugSubType,jdbcType=VARCHAR},
      </if>
      <if test="suit != null" >
        #{suit,jdbcType=VARCHAR},
      </if>
      <if test="phaEffect != null" >
        #{phaEffect,jdbcType=VARCHAR},
      </if>
      <if test="toxClass != null" >
        #{toxClass,jdbcType=VARCHAR},
      </if>
      <if test="physicsTrait != null" >
        #{physicsTrait,jdbcType=VARCHAR},
      </if>
      <if test="otcType != null" >
        #{otcType,jdbcType=VARCHAR},
      </if>
      <if test="medType != null" >
        #{medType,jdbcType=VARCHAR},
      </if>
      <if test="volume != null" >
        #{volume,jdbcType=DECIMAL},
      </if>
      <if test="volUnit != null" >
        #{volUnit,jdbcType=VARCHAR},
      </if>
      <if test="weight != null" >
        #{weight,jdbcType=DECIMAL},
      </if>
      <if test="weightUnit != null" >
        #{weightUnit,jdbcType=VARCHAR},
      </if>
      <if test="concentration != null" >
        #{concentration,jdbcType=DECIMAL},
      </if>
      <if test="defFreq != null" >
        #{defFreq,jdbcType=VARCHAR},
      </if>
      <if test="defDoseQty != null" >
        #{defDoseQty,jdbcType=DECIMAL},
      </if>
      <if test="defDoseUnit != null" >
        #{defDoseUnit,jdbcType=VARCHAR},
      </if>
      <if test="defRoute != null" >
        #{defRoute,jdbcType=VARCHAR},
      </if>
      <if test="barCode != null" >
        #{barCode,jdbcType=VARCHAR},
      </if>
      <if test="manufacturer != null" >
        #{manufacturer,jdbcType=VARCHAR},
      </if>
      <if test="ncmcFlg != null" >
        #{ncmcFlg,jdbcType=VARCHAR},
      </if>
      <if test="approval != null" >
        #{approval,jdbcType=VARCHAR},
      </if>
      <if test="baseDrugFlg != null" >
        #{baseDrugFlg,jdbcType=VARCHAR},
      </if>
      <if test="kickBack != null" >
        #{kickBack,jdbcType=VARCHAR},
      </if>
      <if test="tabu != null" >
        #{tabu,jdbcType=VARCHAR},
      </if>
      <if test="matters != null" >
        #{matters,jdbcType=VARCHAR},
      </if>
      <if test="validFlg != null" >
        #{validFlg,jdbcType=VARCHAR},
      </if>
      <if test="minUnit != null" >
        #{minUnit,jdbcType=VARCHAR},
      </if>
      <if test="packUnit != null" >
        #{packUnit,jdbcType=VARCHAR},
      </if>
      <if test="convQty != null" >
        #{convQty,jdbcType=INTEGER},
      </if>
      <if test="packRetailPrice != null" >
        #{packRetailPrice,jdbcType=REAL},
      </if>
      <if test="minRetailPrice != null" >
        #{minRetailPrice,jdbcType=REAL},
      </if>
      <if test="stockMax != null" >
        #{stockMax,jdbcType=INTEGER},
      </if>
      <if test="stockMin != null" >
        #{stockMin,jdbcType=INTEGER},
      </if>
      <if test="wholesalePrice != null" >
        #{wholesalePrice,jdbcType=REAL},
      </if>
      <if test="billCode != null" >
        #{billCode,jdbcType=VARCHAR},
      </if>
      <if test="virtualPackQty != null" >
        #{virtualPackQty,jdbcType=INTEGER},
      </if>
      <if test="virtualMinQty != null" >
        #{virtualMinQty,jdbcType=INTEGER},
      </if>
    </trim>
  </insert>
  <select id="countByExample" parameterType="com.huatuo.clinics.cms.db.bean.TaPhaDrugInfoExample" resultType="java.lang.Integer" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Fri Aug 12 20:03:22 CST 2016.
    -->
    select count(*) from ta_pha_drug_info
    <if test="_parameter != null" >
      <include refid="Example_Where_Clause" />
    </if>
  </select>
  <update id="updateByExampleSelective" parameterType="map" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Fri Aug 12 20:03:22 CST 2016.
    -->
    update ta_pha_drug_info
    <set >
      <if test="record.phaDrugId != null" >
        pha_drug_id = #{record.phaDrugId,jdbcType=CHAR},
      </if>
      <if test="record.drugTradeId != null" >
        drug_trade_id = #{record.drugTradeId,jdbcType=CHAR},
      </if>
      <if test="record.orgId != null" >
        org_id = #{record.orgId,jdbcType=CHAR},
      </if>
      <if test="record.pharmacyId != null" >
        pharmacy_id = #{record.pharmacyId,jdbcType=CHAR},
      </if>
      <if test="record.tradeName != null" >
        trade_name = #{record.tradeName,jdbcType=VARCHAR},
      </if>
      <if test="record.drugSpec != null" >
        drug_spec = #{record.drugSpec,jdbcType=VARCHAR},
      </if>
      <if test="record.commName != null" >
        comm_name = #{record.commName,jdbcType=VARCHAR},
      </if>
      <if test="record.doseForm != null" >
        dose_form = #{record.doseForm,jdbcType=VARCHAR},
      </if>
      <if test="record.spellCode != null" >
        spell_code = #{record.spellCode,jdbcType=VARCHAR},
      </if>
      <if test="record.wbCode != null" >
        wb_code = #{record.wbCode,jdbcType=VARCHAR},
      </if>
      <if test="record.tSpellCode != null" >
        t_spell_code = #{record.tSpellCode,jdbcType=VARCHAR},
      </if>
      <if test="record.tWbCode != null" >
        t_wb_code = #{record.tWbCode,jdbcType=VARCHAR},
      </if>
      <if test="record.aliasName != null" >
        alias_name = #{record.aliasName,jdbcType=VARCHAR},
      </if>
      <if test="record.component != null" >
        component = #{record.component,jdbcType=VARCHAR},
      </if>
      <if test="record.drugType != null" >
        drug_type = #{record.drugType,jdbcType=VARCHAR},
      </if>
      <if test="record.drugSubType != null" >
        drug_sub_type = #{record.drugSubType,jdbcType=VARCHAR},
      </if>
      <if test="record.suit != null" >
        suit = #{record.suit,jdbcType=VARCHAR},
      </if>
      <if test="record.phaEffect != null" >
        pha_effect = #{record.phaEffect,jdbcType=VARCHAR},
      </if>
      <if test="record.toxClass != null" >
        tox_class = #{record.toxClass,jdbcType=VARCHAR},
      </if>
      <if test="record.physicsTrait != null" >
        physics_trait = #{record.physicsTrait,jdbcType=VARCHAR},
      </if>
      <if test="record.otcType != null" >
        otc_type = #{record.otcType,jdbcType=VARCHAR},
      </if>
      <if test="record.medType != null" >
        med_type = #{record.medType,jdbcType=VARCHAR},
      </if>
      <if test="record.volume != null" >
        volume = #{record.volume,jdbcType=DECIMAL},
      </if>
      <if test="record.volUnit != null" >
        vol_unit = #{record.volUnit,jdbcType=VARCHAR},
      </if>
      <if test="record.weight != null" >
        weight = #{record.weight,jdbcType=DECIMAL},
      </if>
      <if test="record.weightUnit != null" >
        weight_unit = #{record.weightUnit,jdbcType=VARCHAR},
      </if>
      <if test="record.concentration != null" >
        concentration = #{record.concentration,jdbcType=DECIMAL},
      </if>
      <if test="record.defFreq != null" >
        def_freq = #{record.defFreq,jdbcType=VARCHAR},
      </if>
      <if test="record.defDoseQty != null" >
        def_dose_qty = #{record.defDoseQty,jdbcType=DECIMAL},
      </if>
      <if test="record.defDoseUnit != null" >
        def_dose_unit = #{record.defDoseUnit,jdbcType=VARCHAR},
      </if>
      <if test="record.defRoute != null" >
        def_route = #{record.defRoute,jdbcType=VARCHAR},
      </if>
      <if test="record.barCode != null" >
        bar_code = #{record.barCode,jdbcType=VARCHAR},
      </if>
      <if test="record.manufacturer != null" >
        manufacturer = #{record.manufacturer,jdbcType=VARCHAR},
      </if>
      <if test="record.ncmcFlg != null" >
        ncmc_flg = #{record.ncmcFlg,jdbcType=VARCHAR},
      </if>
      <if test="record.approval != null" >
        approval = #{record.approval,jdbcType=VARCHAR},
      </if>
      <if test="record.baseDrugFlg != null" >
        base_drug_flg = #{record.baseDrugFlg,jdbcType=VARCHAR},
      </if>
      <if test="record.kickBack != null" >
        kick_back = #{record.kickBack,jdbcType=VARCHAR},
      </if>
      <if test="record.tabu != null" >
        tabu = #{record.tabu,jdbcType=VARCHAR},
      </if>
      <if test="record.matters != null" >
        matters = #{record.matters,jdbcType=VARCHAR},
      </if>
      <if test="record.validFlg != null" >
        valid_flg = #{record.validFlg,jdbcType=VARCHAR},
      </if>
      <if test="record.minUnit != null" >
        min_unit = #{record.minUnit,jdbcType=VARCHAR},
      </if>
      <if test="record.packUnit != null" >
        pack_unit = #{record.packUnit,jdbcType=VARCHAR},
      </if>
      <if test="record.convQty != null" >
        conv_qty = #{record.convQty,jdbcType=INTEGER},
      </if>
      <if test="record.packRetailPrice != null" >
        pack_retail_price = #{record.packRetailPrice,jdbcType=REAL},
      </if>
      <if test="record.minRetailPrice != null" >
        min_retail_price = #{record.minRetailPrice,jdbcType=REAL},
      </if>
      <if test="record.stockMax != null" >
        stock_max = #{record.stockMax,jdbcType=INTEGER},
      </if>
      <if test="record.stockMin != null" >
        stock_min = #{record.stockMin,jdbcType=INTEGER},
      </if>
      <if test="record.wholesalePrice != null" >
        wholesale_price = #{record.wholesalePrice,jdbcType=REAL},
      </if>
      <if test="record.billCode != null" >
        bill_code = #{record.billCode,jdbcType=VARCHAR},
      </if>
      <if test="record.virtualPackQty != null" >
        virtual_pack_qty = #{record.virtualPackQty,jdbcType=INTEGER},
      </if>
      <if test="record.virtualMinQty != null" >
        virtual_min_qty = #{record.virtualMinQty,jdbcType=INTEGER},
      </if>
    </set>
    <if test="_parameter != null" >
      <include refid="Update_By_Example_Where_Clause" />
    </if>
  </update>
  <update id="updateByExample" parameterType="map" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Fri Aug 12 20:03:22 CST 2016.
    -->
    update ta_pha_drug_info
    set pha_drug_id = #{record.phaDrugId,jdbcType=CHAR},
      drug_trade_id = #{record.drugTradeId,jdbcType=CHAR},
      org_id = #{record.orgId,jdbcType=CHAR},
      pharmacy_id = #{record.pharmacyId,jdbcType=CHAR},
      trade_name = #{record.tradeName,jdbcType=VARCHAR},
      drug_spec = #{record.drugSpec,jdbcType=VARCHAR},
      comm_name = #{record.commName,jdbcType=VARCHAR},
      dose_form = #{record.doseForm,jdbcType=VARCHAR},
      spell_code = #{record.spellCode,jdbcType=VARCHAR},
      wb_code = #{record.wbCode,jdbcType=VARCHAR},
      t_spell_code = #{record.tSpellCode,jdbcType=VARCHAR},
      t_wb_code = #{record.tWbCode,jdbcType=VARCHAR},
      alias_name = #{record.aliasName,jdbcType=VARCHAR},
      component = #{record.component,jdbcType=VARCHAR},
      drug_type = #{record.drugType,jdbcType=VARCHAR},
      drug_sub_type = #{record.drugSubType,jdbcType=VARCHAR},
      suit = #{record.suit,jdbcType=VARCHAR},
      pha_effect = #{record.phaEffect,jdbcType=VARCHAR},
      tox_class = #{record.toxClass,jdbcType=VARCHAR},
      physics_trait = #{record.physicsTrait,jdbcType=VARCHAR},
      otc_type = #{record.otcType,jdbcType=VARCHAR},
      med_type = #{record.medType,jdbcType=VARCHAR},
      volume = #{record.volume,jdbcType=DECIMAL},
      vol_unit = #{record.volUnit,jdbcType=VARCHAR},
      weight = #{record.weight,jdbcType=DECIMAL},
      weight_unit = #{record.weightUnit,jdbcType=VARCHAR},
      concentration = #{record.concentration,jdbcType=DECIMAL},
      def_freq = #{record.defFreq,jdbcType=VARCHAR},
      def_dose_qty = #{record.defDoseQty,jdbcType=DECIMAL},
      def_dose_unit = #{record.defDoseUnit,jdbcType=VARCHAR},
      def_route = #{record.defRoute,jdbcType=VARCHAR},
      bar_code = #{record.barCode,jdbcType=VARCHAR},
      manufacturer = #{record.manufacturer,jdbcType=VARCHAR},
      ncmc_flg = #{record.ncmcFlg,jdbcType=VARCHAR},
      approval = #{record.approval,jdbcType=VARCHAR},
      base_drug_flg = #{record.baseDrugFlg,jdbcType=VARCHAR},
      kick_back = #{record.kickBack,jdbcType=VARCHAR},
      tabu = #{record.tabu,jdbcType=VARCHAR},
      matters = #{record.matters,jdbcType=VARCHAR},
      valid_flg = #{record.validFlg,jdbcType=VARCHAR},
      min_unit = #{record.minUnit,jdbcType=VARCHAR},
      pack_unit = #{record.packUnit,jdbcType=VARCHAR},
      conv_qty = #{record.convQty,jdbcType=INTEGER},
      pack_retail_price = #{record.packRetailPrice,jdbcType=REAL},
      min_retail_price = #{record.minRetailPrice,jdbcType=REAL},
      stock_max = #{record.stockMax,jdbcType=INTEGER},
      stock_min = #{record.stockMin,jdbcType=INTEGER},
      wholesale_price = #{record.wholesalePrice,jdbcType=REAL},
      bill_code = #{record.billCode,jdbcType=VARCHAR},
      virtual_pack_qty = #{record.virtualPackQty,jdbcType=INTEGER},
      virtual_min_qty = #{record.virtualMinQty,jdbcType=INTEGER}
    <if test="_parameter != null" >
      <include refid="Update_By_Example_Where_Clause" />
    </if>
  </update>
  <update id="updateByPrimaryKeySelective" parameterType="com.huatuo.clinics.cms.db.bean.TaPhaDrugInfo" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Fri Aug 12 20:03:22 CST 2016.
    -->
    update ta_pha_drug_info
    <set >
      <if test="drugTradeId != null" >
        drug_trade_id = #{drugTradeId,jdbcType=CHAR},
      </if>
      <if test="orgId != null" >
        org_id = #{orgId,jdbcType=CHAR},
      </if>
      <if test="pharmacyId != null" >
        pharmacy_id = #{pharmacyId,jdbcType=CHAR},
      </if>
      <if test="tradeName != null" >
        trade_name = #{tradeName,jdbcType=VARCHAR},
      </if>
      <if test="drugSpec != null" >
        drug_spec = #{drugSpec,jdbcType=VARCHAR},
      </if>
      <if test="commName != null" >
        comm_name = #{commName,jdbcType=VARCHAR},
      </if>
      <if test="doseForm != null" >
        dose_form = #{doseForm,jdbcType=VARCHAR},
      </if>
      <if test="spellCode != null" >
        spell_code = #{spellCode,jdbcType=VARCHAR},
      </if>
      <if test="wbCode != null" >
        wb_code = #{wbCode,jdbcType=VARCHAR},
      </if>
      <if test="tSpellCode != null" >
        t_spell_code = #{tSpellCode,jdbcType=VARCHAR},
      </if>
      <if test="tWbCode != null" >
        t_wb_code = #{tWbCode,jdbcType=VARCHAR},
      </if>
      <if test="aliasName != null" >
        alias_name = #{aliasName,jdbcType=VARCHAR},
      </if>
      <if test="component != null" >
        component = #{component,jdbcType=VARCHAR},
      </if>
      <if test="drugType != null" >
        drug_type = #{drugType,jdbcType=VARCHAR},
      </if>
      <if test="drugSubType != null" >
        drug_sub_type = #{drugSubType,jdbcType=VARCHAR},
      </if>
      <if test="suit != null" >
        suit = #{suit,jdbcType=VARCHAR},
      </if>
      <if test="phaEffect != null" >
        pha_effect = #{phaEffect,jdbcType=VARCHAR},
      </if>
      <if test="toxClass != null" >
        tox_class = #{toxClass,jdbcType=VARCHAR},
      </if>
      <if test="physicsTrait != null" >
        physics_trait = #{physicsTrait,jdbcType=VARCHAR},
      </if>
      <if test="otcType != null" >
        otc_type = #{otcType,jdbcType=VARCHAR},
      </if>
      <if test="medType != null" >
        med_type = #{medType,jdbcType=VARCHAR},
      </if>
      <if test="volume != null" >
        volume = #{volume,jdbcType=DECIMAL},
      </if>
      <if test="volUnit != null" >
        vol_unit = #{volUnit,jdbcType=VARCHAR},
      </if>
      <if test="weight != null" >
        weight = #{weight,jdbcType=DECIMAL},
      </if>
      <if test="weightUnit != null" >
        weight_unit = #{weightUnit,jdbcType=VARCHAR},
      </if>
      <if test="concentration != null" >
        concentration = #{concentration,jdbcType=DECIMAL},
      </if>
      <if test="defFreq != null" >
        def_freq = #{defFreq,jdbcType=VARCHAR},
      </if>
      <if test="defDoseQty != null" >
        def_dose_qty = #{defDoseQty,jdbcType=DECIMAL},
      </if>
      <if test="defDoseUnit != null" >
        def_dose_unit = #{defDoseUnit,jdbcType=VARCHAR},
      </if>
      <if test="defRoute != null" >
        def_route = #{defRoute,jdbcType=VARCHAR},
      </if>
      <if test="barCode != null" >
        bar_code = #{barCode,jdbcType=VARCHAR},
      </if>
      <if test="manufacturer != null" >
        manufacturer = #{manufacturer,jdbcType=VARCHAR},
      </if>
      <if test="ncmcFlg != null" >
        ncmc_flg = #{ncmcFlg,jdbcType=VARCHAR},
      </if>
      <if test="approval != null" >
        approval = #{approval,jdbcType=VARCHAR},
      </if>
      <if test="baseDrugFlg != null" >
        base_drug_flg = #{baseDrugFlg,jdbcType=VARCHAR},
      </if>
      <if test="kickBack != null" >
        kick_back = #{kickBack,jdbcType=VARCHAR},
      </if>
      <if test="tabu != null" >
        tabu = #{tabu,jdbcType=VARCHAR},
      </if>
      <if test="matters != null" >
        matters = #{matters,jdbcType=VARCHAR},
      </if>
      <if test="validFlg != null" >
        valid_flg = #{validFlg,jdbcType=VARCHAR},
      </if>
      <if test="minUnit != null" >
        min_unit = #{minUnit,jdbcType=VARCHAR},
      </if>
      <if test="packUnit != null" >
        pack_unit = #{packUnit,jdbcType=VARCHAR},
      </if>
      <if test="convQty != null" >
        conv_qty = #{convQty,jdbcType=INTEGER},
      </if>
      <if test="packRetailPrice != null" >
        pack_retail_price = #{packRetailPrice,jdbcType=REAL},
      </if>
      <if test="minRetailPrice != null" >
        min_retail_price = #{minRetailPrice,jdbcType=REAL},
      </if>
      <if test="stockMax != null" >
        stock_max = #{stockMax,jdbcType=INTEGER},
      </if>
      <if test="stockMin != null" >
        stock_min = #{stockMin,jdbcType=INTEGER},
      </if>
      <if test="wholesalePrice != null" >
        wholesale_price = #{wholesalePrice,jdbcType=REAL},
      </if>
      <if test="billCode != null" >
        bill_code = #{billCode,jdbcType=VARCHAR},
      </if>
      <if test="virtualPackQty != null" >
        virtual_pack_qty = #{virtualPackQty,jdbcType=INTEGER},
      </if>
      <if test="virtualMinQty != null" >
        virtual_min_qty = #{virtualMinQty,jdbcType=INTEGER},
      </if>
    </set>
    where pha_drug_id = #{phaDrugId,jdbcType=CHAR}
  </update>
  <update id="updateByPrimaryKey" parameterType="com.huatuo.clinics.cms.db.bean.TaPhaDrugInfo" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Fri Aug 12 20:03:22 CST 2016.
    -->
    update ta_pha_drug_info
    set drug_trade_id = #{drugTradeId,jdbcType=CHAR},
      org_id = #{orgId,jdbcType=CHAR},
      pharmacy_id = #{pharmacyId,jdbcType=CHAR},
      trade_name = #{tradeName,jdbcType=VARCHAR},
      drug_spec = #{drugSpec,jdbcType=VARCHAR},
      comm_name = #{commName,jdbcType=VARCHAR},
      dose_form = #{doseForm,jdbcType=VARCHAR},
      spell_code = #{spellCode,jdbcType=VARCHAR},
      wb_code = #{wbCode,jdbcType=VARCHAR},
      t_spell_code = #{tSpellCode,jdbcType=VARCHAR},
      t_wb_code = #{tWbCode,jdbcType=VARCHAR},
      alias_name = #{aliasName,jdbcType=VARCHAR},
      component = #{component,jdbcType=VARCHAR},
      drug_type = #{drugType,jdbcType=VARCHAR},
      drug_sub_type = #{drugSubType,jdbcType=VARCHAR},
      suit = #{suit,jdbcType=VARCHAR},
      pha_effect = #{phaEffect,jdbcType=VARCHAR},
      tox_class = #{toxClass,jdbcType=VARCHAR},
      physics_trait = #{physicsTrait,jdbcType=VARCHAR},
      otc_type = #{otcType,jdbcType=VARCHAR},
      med_type = #{medType,jdbcType=VARCHAR},
      volume = #{volume,jdbcType=DECIMAL},
      vol_unit = #{volUnit,jdbcType=VARCHAR},
      weight = #{weight,jdbcType=DECIMAL},
      weight_unit = #{weightUnit,jdbcType=VARCHAR},
      concentration = #{concentration,jdbcType=DECIMAL},
      def_freq = #{defFreq,jdbcType=VARCHAR},
      def_dose_qty = #{defDoseQty,jdbcType=DECIMAL},
      def_dose_unit = #{defDoseUnit,jdbcType=VARCHAR},
      def_route = #{defRoute,jdbcType=VARCHAR},
      bar_code = #{barCode,jdbcType=VARCHAR},
      manufacturer = #{manufacturer,jdbcType=VARCHAR},
      ncmc_flg = #{ncmcFlg,jdbcType=VARCHAR},
      approval = #{approval,jdbcType=VARCHAR},
      base_drug_flg = #{baseDrugFlg,jdbcType=VARCHAR},
      kick_back = #{kickBack,jdbcType=VARCHAR},
      tabu = #{tabu,jdbcType=VARCHAR},
      matters = #{matters,jdbcType=VARCHAR},
      valid_flg = #{validFlg,jdbcType=VARCHAR},
      min_unit = #{minUnit,jdbcType=VARCHAR},
      pack_unit = #{packUnit,jdbcType=VARCHAR},
      conv_qty = #{convQty,jdbcType=INTEGER},
      pack_retail_price = #{packRetailPrice,jdbcType=REAL},
      min_retail_price = #{minRetailPrice,jdbcType=REAL},
      stock_max = #{stockMax,jdbcType=INTEGER},
      stock_min = #{stockMin,jdbcType=INTEGER},
      wholesale_price = #{wholesalePrice,jdbcType=REAL},
      bill_code = #{billCode,jdbcType=VARCHAR},
      virtual_pack_qty = #{virtualPackQty,jdbcType=INTEGER},
      virtual_min_qty = #{virtualMinQty,jdbcType=INTEGER}
    where pha_drug_id = #{phaDrugId,jdbcType=CHAR}
  </update>
     <!-- 自定义sql -->
  <select id="countList" parameterType="java.util.Map" resultType="java.lang.Integer">
      SELECT count(*) FROM ta_pha_drug_info info JOIN  ta_pha_stocktaking_dtl i ON i.pha_drug_id = info.pha_drug_id
	       <where>
             <if test="stocktakingId != null">
			    i.stocktaking_id = #{stocktakingId,jdbcType=OTHER} 
		     </if>
		   </where>
  </select>
  
  <select id="queryList" parameterType="java.util.Map" resultMap="zdyStocktake">
       SELECT info.* ,i.item_no,i.pack_qty,i.pack_real_qty,i.min_qty,i.min_real_qty,i.instock_batch
             FROM ta_pha_drug_info info JOIN  ta_pha_stocktaking_dtl i ON i.pha_drug_id = info.pha_drug_id
           <where>
             <if test="stocktakingId != null">
  			     i.stocktaking_id = #{stocktakingId,jdbcType=OTHER} 
  		     </if>
		   </where>
		   ORDER BY info.trade_name,i.instock_batch DESC
  </select>
  
<!-- 自定义分页sql -->
   <sql id="whereSql">
		<where>
			<if test="type==1 and key!=null and key!=''">
				(ta.trade_name like concat('%',#{key},'%') or 
				ta.comm_name like concat('%',#{key},'%') or  
				ta.t_wb_code like concat('%',#{key},'%') or  
				ta.t_spell_code like concat('%',#{key},'%'))
			</if>
			<if test="type==2 and key!=null and key!=''">
				ta.otc_type like concat('%',#{key},'%') 
			</if>
			<if test="type==3 and key!=null and key!=''">
				ta.manufacturer like concat('%',#{key},'%')
			</if>
			<if test="type==4 and key!=null and key!=''">
				ta.base_drug_flg like concat('%',#{key},'%')
			</if>
			<if test="type==5 and key!=null and key!=''">
				ta.ncmc_flg like concat('%',#{key},'%')
			</if>
			<if test="type==6 and key!=null and key!=''">
				ta.med_type like concat('%',#{key},'%')
			</if>
			<if test="type==7 and key!=null and key!=''">
				ta.dose_form like concat('%',#{key},'%')
			</if>
			<if test="orgId != null and orgId != '' ">
			  and ta.org_id=#{orgId,jdbcType=OTHER}
			</if>
			  and ts.instock_batch IS NOT null
		</where>
	</sql>
  
  <select id="queryCount" parameterType="java.util.Map" resultType="java.lang.Integer">
	  select count(*) from ta_pha_drug_info ta 
    LEFT JOIN ta_pha_drug_inventory ts
	ON (ta.pha_drug_id=ts.pha_drug_id)
	 	<include refid="whereSql" />
  </select>
  
  <select id="pageList" parameterType="java.util.Map" resultMap="BaseResultMap">
    select * from ta_pha_drug_info ta 
    LEFT JOIN ta_pha_drug_inventory ts
	ON (ta.pha_drug_id=ts.pha_drug_id)
	    <include refid="whereSql" />
	    GROUP BY ta.drug_trade_id
	    limit #{begin} , #{pageSize}
  </select>
  
  <update id="updateWp" parameterType="com.huatuo.clinics.cms.db.bean.TaPhaDrugInfo" >
  		update ta_pha_drug_info s
  		set 
  			<if test=" wholesalePrice != null and  wholesalePrice != 0 ">
  				s.wholesale_price=#{wholesalePrice,jdbcType=OTHER},
  			</if>
  			<if test=" packRetailPrice != null ">
  				s.pack_retail_price=#{packRetailPrice,jdbcType=OTHER},
  			</if>
  			<if test=" minRetailPrice != null ">
  				s.min_retail_price=#{minRetailPrice,jdbcType=OTHER}
  			</if>
  			<where>
  				<if test="phaDrugId != null">
  					s.pha_drug_id=#{phaDrugId,jdbcType=OTHER}
  				</if>
  			</where>
  </update>
  
  <sql id="whereSqlInfo">
		<where>
			<if test="type==1 and key!=null and key!=''">
				(
				trade_name like concat('%',#{key},'%') or 
				comm_name like concat('%',#{key},'%') or  
				t_wb_code like concat('%',#{key},'%') or  
				t_spell_code like concat('%',#{key},'%')
				)
			</if>
			<if test="orgId != null and orgId != '' ">
			  and org_id=#{orgId}
			</if>
		</where>
	</sql>
  
  <select id="countInfo" parameterType="java.util.Map" resultType="java.lang.Integer">
	  select count(*) from ta_pha_drug_info
	 	<include refid="whereSqlInfo" />
  </select>
  
  <select id="pageListInfo" parameterType="java.util.Map" resultMap="BaseResultMap">
    select * from ta_pha_drug_info
	    <include refid="whereSqlInfo" />
	    limit #{begin} , #{pageSize}
  </select>
  
    <!-- 新增时判断是否存在 -->
  <select id="queryIsExist" parameterType="com.huatuo.clinics.cms.db.bean.TaPhaDrugInfo" resultMap="BaseResultMap">
  	SELECT * FROM ta_pha_drug_info 
  		<where>
<!-- 			<if test="drugTradeId != null and drugTradeId !=''"> -->
<!-- 			drug_trade_id = #{drugTradeId} -->
<!-- 			</if> -->
			<if test="orgId != null and orgId !=''">
			AND org_id = #{orgId}
			</if>
			<if test="pharmacyId != null and pharmacyId !=''">
			AND pharmacy_id = #{pharmacyId}
			</if>
			<if test="tradeName != null and tradeName !=''">
			AND trade_name = #{tradeName}
			</if>
			<if test="volume != null">
			AND volume = #{volume}
			</if>
			<if test="volUnit != null and volUnit !=''">
			AND vol_unit = #{volUnit}
			</if>
			<if test="weight != null">
			AND weight = #{weight}
			</if>
			<if test="weightUnit != null and weightUnit !=''">
			AND weight_unit = #{weightUnit}
			</if>
			<if test="manufacturer != null and manufacturer !=''">
			AND manufacturer = #{manufacturer}
			</if>
			<if test="minUnit != null and minUnit !=''">
			AND min_unit = #{minUnit}
			</if>
			<if test="packUnit != null and packUnit !=''">
			AND pack_unit = #{packUnit}
			</if>
			<if test="convQty != null">
			AND conv_qty = #{convQty}
			</if>
			<if test="phaDrugId != null and phaDrugId !=''">
			AND pha_drug_id != #{phaDrugId}
			</if>
		</where>
  </select>
</mapper>
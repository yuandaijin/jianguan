<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.huatuo.clinics.cms.db.mapper.SmCliAreaCoverMapper" >
  <resultMap id="BaseResultMap" type="com.huatuo.clinics.cms.db.bean.SmCliAreaCover" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Thu Aug 11 17:33:42 CST 2016.
    -->
    <id column="area_cover_id" property="areaCoverId" jdbcType="CHAR" />
    <result column="area_code" property="areaCode" jdbcType="CHAR" />
    <result column="area_name" property="areaName" jdbcType="CHAR" />
    <result column="parent_area_name" property="parentAreaName" jdbcType="CHAR" />
    <result column="parent_area_code" property="parentAreaCode" jdbcType="CHAR" />
    <result column="year" property="year" jdbcType="INTEGER" />
    <result column="month" property="month" jdbcType="INTEGER" />
    <result column="day" property="day" jdbcType="INTEGER" />
    <result column="clinic_qty" property="clinicQty" jdbcType="INTEGER" />
    <result column="doctor_qty" property="doctorQty" jdbcType="INTEGER" />
    <result column="nurse_qty" property="nurseQty" jdbcType="INTEGER" />
    <result column="other_qty" property="otherQty" jdbcType="INTEGER" />
    <result column="record_date" property="recordDate" jdbcType="TIMESTAMP" />
    <result column="update_date" property="updateDate" jdbcType="TIMESTAMP" />
  </resultMap>
  <sql id="Example_Where_Clause" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Thu Aug 11 17:33:42 CST 2016.
    -->
    <where >
      <foreach collection="oredCriteria" item="criteria" separator="or" >
        <if test="criteria.valid" >
          <trim prefix="(" suffix=")" prefixOverrides="and" >
            <foreach collection="criteria.criteria" item="criterion" >
              <choose >
                <when test="criterion.noValue" >
                  and ${criterion.condition}
                </when>
                <when test="criterion.singleValue" >
                  and ${criterion.condition} #{criterion.value}
                </when>
                <when test="criterion.betweenValue" >
                  and ${criterion.condition} #{criterion.value} and #{criterion.secondValue}
                </when>
                <when test="criterion.listValue" >
                  and ${criterion.condition}
                  <foreach collection="criterion.value" item="listItem" open="(" close=")" separator="," >
                    #{listItem}
                  </foreach>
                </when>
              </choose>
            </foreach>
          </trim>
        </if>
      </foreach>
    </where>
  </sql>
  <sql id="Update_By_Example_Where_Clause" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Thu Aug 11 17:33:42 CST 2016.
    -->
    <where >
      <foreach collection="example.oredCriteria" item="criteria" separator="or" >
        <if test="criteria.valid" >
          <trim prefix="(" suffix=")" prefixOverrides="and" >
            <foreach collection="criteria.criteria" item="criterion" >
              <choose >
                <when test="criterion.noValue" >
                  and ${criterion.condition}
                </when>
                <when test="criterion.singleValue" >
                  and ${criterion.condition} #{criterion.value}
                </when>
                <when test="criterion.betweenValue" >
                  and ${criterion.condition} #{criterion.value} and #{criterion.secondValue}
                </when>
                <when test="criterion.listValue" >
                  and ${criterion.condition}
                  <foreach collection="criterion.value" item="listItem" open="(" close=")" separator="," >
                    #{listItem}
                  </foreach>
                </when>
              </choose>
            </foreach>
          </trim>
        </if>
      </foreach>
    </where>
  </sql>
  <sql id="Base_Column_List" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Thu Aug 11 17:33:42 CST 2016.
    -->
    area_cover_id, area_code, area_name, parent_area_name, parent_area_code, year, month, 
    day, clinic_qty, doctor_qty, nurse_qty, other_qty, record_date, update_date
  </sql>
  <select id="selectByExample" resultMap="BaseResultMap" parameterType="com.huatuo.clinics.cms.db.bean.SmCliAreaCoverExample" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Thu Aug 11 17:33:42 CST 2016.
    -->
    select
    <if test="distinct" >
      distinct
    </if>
    <include refid="Base_Column_List" />
    from sm_cli_area_cover
    <if test="_parameter != null" >
      <include refid="Example_Where_Clause" />
    </if>
    <if test="orderByClause != null" >
      order by ${orderByClause}
    </if>
  </select>
  <select id="selectByPrimaryKey" resultMap="BaseResultMap" parameterType="java.lang.String" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Thu Aug 11 17:33:42 CST 2016.
    -->
    select 
    <include refid="Base_Column_List" />
    from sm_cli_area_cover
    where area_cover_id = #{areaCoverId,jdbcType=CHAR}
  </select>
  <delete id="deleteByPrimaryKey" parameterType="java.lang.String" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Thu Aug 11 17:33:42 CST 2016.
    -->
    delete from sm_cli_area_cover
    where area_cover_id = #{areaCoverId,jdbcType=CHAR}
  </delete>
  <delete id="deleteByExample" parameterType="com.huatuo.clinics.cms.db.bean.SmCliAreaCoverExample" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Thu Aug 11 17:33:42 CST 2016.
    -->
    delete from sm_cli_area_cover
    <if test="_parameter != null" >
      <include refid="Example_Where_Clause" />
    </if>
  </delete>
  <insert id="insert" parameterType="com.huatuo.clinics.cms.db.bean.SmCliAreaCover" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Thu Aug 11 17:33:42 CST 2016.
    -->
    insert into sm_cli_area_cover (area_cover_id, area_code, area_name, 
      parent_area_name, parent_area_code, year, 
      month, day, clinic_qty, 
      doctor_qty, nurse_qty, other_qty, 
      record_date, update_date)
    values (#{areaCoverId,jdbcType=CHAR}, #{areaCode,jdbcType=CHAR}, #{areaName,jdbcType=CHAR}, 
      #{parentAreaName,jdbcType=CHAR}, #{parentAreaCode,jdbcType=CHAR}, #{year,jdbcType=INTEGER}, 
      #{month,jdbcType=INTEGER}, #{day,jdbcType=INTEGER}, #{clinicQty,jdbcType=INTEGER}, 
      #{doctorQty,jdbcType=INTEGER}, #{nurseQty,jdbcType=INTEGER}, #{otherQty,jdbcType=INTEGER}, 
      #{recordDate,jdbcType=TIMESTAMP}, #{updateDate,jdbcType=TIMESTAMP})
  </insert>
  <insert id="insertSelective" parameterType="com.huatuo.clinics.cms.db.bean.SmCliAreaCover" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Thu Aug 11 17:33:42 CST 2016.
    -->
    insert into sm_cli_area_cover
    <trim prefix="(" suffix=")" suffixOverrides="," >
      <if test="areaCoverId != null" >
        area_cover_id,
      </if>
      <if test="areaCode != null" >
        area_code,
      </if>
      <if test="areaName != null" >
        area_name,
      </if>
      <if test="parentAreaName != null" >
        parent_area_name,
      </if>
      <if test="parentAreaCode != null" >
        parent_area_code,
      </if>
      <if test="year != null" >
        year,
      </if>
      <if test="month != null" >
        month,
      </if>
      <if test="day != null" >
        day,
      </if>
      <if test="clinicQty != null" >
        clinic_qty,
      </if>
      <if test="doctorQty != null" >
        doctor_qty,
      </if>
      <if test="nurseQty != null" >
        nurse_qty,
      </if>
      <if test="otherQty != null" >
        other_qty,
      </if>
      <if test="recordDate != null" >
        record_date,
      </if>
      <if test="updateDate != null" >
        update_date,
      </if>
    </trim>
    <trim prefix="values (" suffix=")" suffixOverrides="," >
      <if test="areaCoverId != null" >
        #{areaCoverId,jdbcType=CHAR},
      </if>
      <if test="areaCode != null" >
        #{areaCode,jdbcType=CHAR},
      </if>
      <if test="areaName != null" >
        #{areaName,jdbcType=CHAR},
      </if>
      <if test="parentAreaName != null" >
        #{parentAreaName,jdbcType=CHAR},
      </if>
      <if test="parentAreaCode != null" >
        #{parentAreaCode,jdbcType=CHAR},
      </if>
      <if test="year != null" >
        #{year,jdbcType=INTEGER},
      </if>
      <if test="month != null" >
        #{month,jdbcType=INTEGER},
      </if>
      <if test="day != null" >
        #{day,jdbcType=INTEGER},
      </if>
      <if test="clinicQty != null" >
        #{clinicQty,jdbcType=INTEGER},
      </if>
      <if test="doctorQty != null" >
        #{doctorQty,jdbcType=INTEGER},
      </if>
      <if test="nurseQty != null" >
        #{nurseQty,jdbcType=INTEGER},
      </if>
      <if test="otherQty != null" >
        #{otherQty,jdbcType=INTEGER},
      </if>
      <if test="recordDate != null" >
        #{recordDate,jdbcType=TIMESTAMP},
      </if>
      <if test="updateDate != null" >
        #{updateDate,jdbcType=TIMESTAMP},
      </if>
    </trim>
  </insert>
  <select id="countByExample" parameterType="com.huatuo.clinics.cms.db.bean.SmCliAreaCoverExample" resultType="java.lang.Integer" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Thu Aug 11 17:33:42 CST 2016.
    -->
    select count(*) from sm_cli_area_cover
    <if test="_parameter != null" >
      <include refid="Example_Where_Clause" />
    </if>
  </select>
  <update id="updateByExampleSelective" parameterType="map" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Thu Aug 11 17:33:42 CST 2016.
    -->
    update sm_cli_area_cover
    <set >
      <if test="record.areaCoverId != null" >
        area_cover_id = #{record.areaCoverId,jdbcType=CHAR},
      </if>
      <if test="record.areaCode != null" >
        area_code = #{record.areaCode,jdbcType=CHAR},
      </if>
      <if test="record.areaName != null" >
        area_name = #{record.areaName,jdbcType=CHAR},
      </if>
      <if test="record.parentAreaName != null" >
        parent_area_name = #{record.parentAreaName,jdbcType=CHAR},
      </if>
      <if test="record.parentAreaCode != null" >
        parent_area_code = #{record.parentAreaCode,jdbcType=CHAR},
      </if>
      <if test="record.year != null" >
        year = #{record.year,jdbcType=INTEGER},
      </if>
      <if test="record.month != null" >
        month = #{record.month,jdbcType=INTEGER},
      </if>
      <if test="record.day != null" >
        day = #{record.day,jdbcType=INTEGER},
      </if>
      <if test="record.clinicQty != null" >
        clinic_qty = #{record.clinicQty,jdbcType=INTEGER},
      </if>
      <if test="record.doctorQty != null" >
        doctor_qty = #{record.doctorQty,jdbcType=INTEGER},
      </if>
      <if test="record.nurseQty != null" >
        nurse_qty = #{record.nurseQty,jdbcType=INTEGER},
      </if>
      <if test="record.otherQty != null" >
        other_qty = #{record.otherQty,jdbcType=INTEGER},
      </if>
      <if test="record.recordDate != null" >
        record_date = #{record.recordDate,jdbcType=TIMESTAMP},
      </if>
      <if test="record.updateDate != null" >
        update_date = #{record.updateDate,jdbcType=TIMESTAMP},
      </if>
    </set>
    <if test="_parameter != null" >
      <include refid="Update_By_Example_Where_Clause" />
    </if>
  </update>
  <update id="updateByExample" parameterType="map" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Thu Aug 11 17:33:42 CST 2016.
    -->
    update sm_cli_area_cover
    set area_cover_id = #{record.areaCoverId,jdbcType=CHAR},
      area_code = #{record.areaCode,jdbcType=CHAR},
      area_name = #{record.areaName,jdbcType=CHAR},
      parent_area_name = #{record.parentAreaName,jdbcType=CHAR},
      parent_area_code = #{record.parentAreaCode,jdbcType=CHAR},
      year = #{record.year,jdbcType=INTEGER},
      month = #{record.month,jdbcType=INTEGER},
      day = #{record.day,jdbcType=INTEGER},
      clinic_qty = #{record.clinicQty,jdbcType=INTEGER},
      doctor_qty = #{record.doctorQty,jdbcType=INTEGER},
      nurse_qty = #{record.nurseQty,jdbcType=INTEGER},
      other_qty = #{record.otherQty,jdbcType=INTEGER},
      record_date = #{record.recordDate,jdbcType=TIMESTAMP},
      update_date = #{record.updateDate,jdbcType=TIMESTAMP}
    <if test="_parameter != null" >
      <include refid="Update_By_Example_Where_Clause" />
    </if>
  </update>
  <update id="updateByPrimaryKeySelective" parameterType="com.huatuo.clinics.cms.db.bean.SmCliAreaCover" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Thu Aug 11 17:33:42 CST 2016.
    -->
    update sm_cli_area_cover
    <set >
      <if test="areaCode != null" >
        area_code = #{areaCode,jdbcType=CHAR},
      </if>
      <if test="areaName != null" >
        area_name = #{areaName,jdbcType=CHAR},
      </if>
      <if test="parentAreaName != null" >
        parent_area_name = #{parentAreaName,jdbcType=CHAR},
      </if>
      <if test="parentAreaCode != null" >
        parent_area_code = #{parentAreaCode,jdbcType=CHAR},
      </if>
      <if test="year != null" >
        year = #{year,jdbcType=INTEGER},
      </if>
      <if test="month != null" >
        month = #{month,jdbcType=INTEGER},
      </if>
      <if test="day != null" >
        day = #{day,jdbcType=INTEGER},
      </if>
      <if test="clinicQty != null" >
        clinic_qty = #{clinicQty,jdbcType=INTEGER},
      </if>
      <if test="doctorQty != null" >
        doctor_qty = #{doctorQty,jdbcType=INTEGER},
      </if>
      <if test="nurseQty != null" >
        nurse_qty = #{nurseQty,jdbcType=INTEGER},
      </if>
      <if test="otherQty != null" >
        other_qty = #{otherQty,jdbcType=INTEGER},
      </if>
      <if test="recordDate != null" >
        record_date = #{recordDate,jdbcType=TIMESTAMP},
      </if>
      <if test="updateDate != null" >
        update_date = #{updateDate,jdbcType=TIMESTAMP},
      </if>
    </set>
    where area_cover_id = #{areaCoverId,jdbcType=CHAR}
  </update>
  <update id="updateByPrimaryKey" parameterType="com.huatuo.clinics.cms.db.bean.SmCliAreaCover" >
    <!--
      WARNING - @mbggenerated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Thu Aug 11 17:33:42 CST 2016.
    -->
    update sm_cli_area_cover
    set area_code = #{areaCode,jdbcType=CHAR},
      area_name = #{areaName,jdbcType=CHAR},
      parent_area_name = #{parentAreaName,jdbcType=CHAR},
      parent_area_code = #{parentAreaCode,jdbcType=CHAR},
      year = #{year,jdbcType=INTEGER},
      month = #{month,jdbcType=INTEGER},
      day = #{day,jdbcType=INTEGER},
      clinic_qty = #{clinicQty,jdbcType=INTEGER},
      doctor_qty = #{doctorQty,jdbcType=INTEGER},
      nurse_qty = #{nurseQty,jdbcType=INTEGER},
      other_qty = #{otherQty,jdbcType=INTEGER},
      record_date = #{recordDate,jdbcType=TIMESTAMP},
      update_date = #{updateDate,jdbcType=TIMESTAMP}
    where area_cover_id = #{areaCoverId,jdbcType=CHAR}
  </update>
  
  <select id="queryNameAndQty" parameterType="java.util.Map" resultType="com.huatuo.clinics.cms.db.bean.ReportResultDB">
  	 select
     	s.clinic_qty qty,s.area_name name
     from sm_cli_area_cover  s
     <where>
     	<if test="parentAreaCode != null">
     		s.parent_area_code=#{parentAreaCode,jdbcType=OTHER}
     	</if>
     		and s.year=#{year,jdbcType=OTHER}  
     		and  s.month=#{month,jdbcType=OTHER} 
     		and s.day=#{day,jdbcType=OTHER}
     </where>  
         group by s.area_name
         ORDER BY CONVERT(name USING gbk) ASC
  </select>
  
   <select id="queryIncidence" parameterType="java.util.Map" resultType="com.huatuo.clinics.cms.db.bean.ReportResultDB">
  		select sum(a.qty) qty,b.sickness_name name
		from sm_cli_area_cover_dtl a
		left join sm_cli_area_sickness_info b
		on(a.area_cover_id=b.area_cover_id and a.source= b.source)
		left join sm_cli_area_cover s
		on(a.area_cover_id=s.area_cover_id)
			<where>
				      <if test="parentAreaCode != null">
				     		s.area_code=#{parentAreaCode,jdbcType=OTHER}
					   </if>
					     	and s.year=#{year,jdbcType=OTHER}    and s.month=#{month,jdbcType=OTHER}
					     	and s.area_flag=1
                and a.source IN('00068','00069','00070','00071','00072','00073','00074','00075','00076','00077')          
		</where>
		group by a.source
		order by qty desc
  </select>
  
  
    <select id="queryIncidenceSum" parameterType="java.util.Map" resultType="java.lang.String">
  		select sum(a.qty) qty
		from sm_cli_area_cover_dtl a
		left join sm_cli_area_cover s
		on(a.area_cover_id=s.area_cover_id)
			<where>
	                            <if test="parentAreaCode != null">
					     		s.parent_area_code=#{parentAreaCode,jdbcType=OTHER}
						     	</if>
						     and s.year=#{year,jdbcType=OTHER}    
						     and s.month=#{month,jdbcType=OTHER}
					     	 and s.area_flag=1
                			 and a.type ='00049-0001'          
			</where>
  </select>
  
  
  <select id="queryDiseasesSum" parameterType="java.util.Map" resultType="java.lang.String">
  		select sum(a.qty) qty
		from sm_cli_area_cover_dtl a
		left join sm_cli_area_cover s
		on(a.area_cover_id=s.area_cover_id)
			<where>
					     	<if test="parentAreaCode != null">
					     		s.area_code=#{parentAreaCode,jdbcType=OTHER} 
					     	</if>
					     	<if test="reportType == 'year' ">
					     		and s.year=#{year,jdbcType=OTHER} and s.area_flag=2
					     	</if>
					     	<if test="reportType == 'quarter' ">
					     		and s.year=#{year,jdbcType=OTHER} 
					     		and s.month&gt;=#{startMonth,jdbcType=OTHER} 
					     		and s.month&lt;=#{endMonth,jdbcType=OTHER}
					     		and s.area_flag=1
					     	</if>
					     	<if test="reportType == 'month' ">
					     		and s.year=#{year,jdbcType=OTHER} and s.month=#{startMonth,jdbcType=OTHER}
					     		and s.area_flag=1
					     	</if>
					     	<if test="reportType == 'day' ">
					     		and s.year=#{year,jdbcType=OTHER} and s.month=#{startMonth,jdbcType=OTHER}
					     		and s.day=#{day,jdbcType=OTHER} and s.area_flag=0
					     	</if>
                and a.type ='00049-0001'         
		</where>
  </select>
  
  <select id="queryDiseases" parameterType="java.util.Map" resultType="com.huatuo.clinics.cms.db.bean.ReportResultDB">
  		select sum(a.qty) qty,b.sickness_name name
		from sm_cli_area_cover_dtl a
		left join sm_cli_area_sickness_info b
		on(a.area_cover_id=b.area_cover_id and a.source= b.source)
		left join sm_cli_area_cover s
		on(a.area_cover_id=s.area_cover_id)
			<where>
					     	<if test="parentAreaCode != null">
					     		s.area_code=#{parentAreaCode,jdbcType=OTHER} 
					     	</if>
					     	<if test="reportType == 'year' ">
					     		and s.year=#{year,jdbcType=OTHER} and area_flag=2
					     	</if>
					     	<if test="reportType == 'quarter' ">
					     		and s.year=#{year,jdbcType=OTHER} 
					     		and s.month&gt;=#{startMonth,jdbcType=OTHER} 
					     		and s.month&lt;=#{endMonth,jdbcType=OTHER}
					     		and area_flag=1
					     	</if>
					     	<if test="reportType == 'month' ">
					     		and s.year=#{year,jdbcType=OTHER} and s.month=#{startMonth,jdbcType=OTHER}
					     		and area_flag=1
					     	</if>
					     	<if test="reportType == 'day' ">
					     		and s.year=#{year,jdbcType=OTHER} and s.month=#{startMonth,jdbcType=OTHER}
					     		and s.day=#{day,jdbcType=OTHER} and s.area_flag=0
					     	</if>
                and a.source IN('00068','00069','00070','00071','00072','00073','00074','00075','00076','00077')          
		</where>
		group by a.source
		order by qty desc
  </select>
  
  
  <select id="queryGrade" parameterType="java.util.Map" resultType="com.huatuo.clinics.cms.db.bean.ReportResultDB">
  		select sum(a.qty) qty,b.dict_item_name name 
		from sm_cli_area_cover_dtl a
		left join ss_dic_item b 
		on(a.type=b.dict_item_value)
		left join sm_cli_area_cover s
		on(a.area_cover_id=s.area_cover_id)
		<where> 
                         <if test="parentAreaCode != null">
				     		s.parent_area_code=#{parentAreaCode,jdbcType=OTHER}
				     	</if>
				     	 and s.year=#{year,jdbcType=OTHER}  
			     		 and  s.month=#{month,jdbcType=OTHER} 
			     		 and s.day=#{day,jdbcType=OTHER}
        </where>                      
               and a.source='00042'   
               group by b.dict_item_name
               order by a.type
  </select>
  
  <select id="queryOperate" parameterType="java.util.Map" resultType="com.huatuo.clinics.cms.db.bean.ReportResultDB">
  			select d.area_name name, b.dict_item_name type,sum(a.qty) qty
		from sm_cli_area_cover_dtl a
		left join ss_dic_item b 
		on(a.type=b.dict_item_value)
		left join sm_cli_area_cover d 
		on(a.area_cover_id=d.area_cover_id)
		<where> 
                <if test="parentAreaCode != null">
				     d.parent_area_code=#{parentAreaCode,jdbcType=OTHER}
				</if>
				<if test="flag == 0">
				     and d.year=#{year,jdbcType=OTHER} and d.month=#{month,jdbcType=OTHER}   and d.area_flag=1
				 </if>
				<if test="flag == 1">
				     and d.year=#{year,jdbcType=OTHER} and area_flag=2
			   </if>
				     and a.source='00049' 
               <if test="sourceCode != null">
					and a.type=#{sourceCode,jdbcType=OTHER}
				</if>
        </where>                      
               group by d.area_name
               ORDER BY CONVERT(name USING gbk) ASC
  </select>
  
  
  
  <select  id="select" parameterType="com.huatuo.clinics.cms.bean.RuquestBeanDTO" resultMap="BaseResultMap">
  				select * from sm_cli_area_cover s
  				<where>
                         <if test="parentAreaCode != null">
				     		s.parent_area_code=#{parentAreaCode,jdbcType=OTHER}
				     	</if>
				     	<if test="year != null">
				     		and s.year=#{year,jdbcType=OTHER}
				     	</if>
				     	<if test="month != null">
				     		and  s.month=#{month,jdbcType=OTHER}
				     	</if>
				     	<if test="day != null">
				     		and s.day=#{day,jdbcType=OTHER}
				     	</if>
				     	<if test="areaCode != null">
				     		and  s.area_code=#{areaCode,jdbcType=OTHER}
				     	</if>
				     	<if test="startTime != null">
				     		and  s.record_date&lt;=#{startTime,jdbcType=OTHER}
				     	</if>
				     	</where>
  </select>
  <select id="queryType" parameterType="com.huatuo.clinics.cms.bean.RuquestBeanDTO"  resultType="com.huatuo.clinics.cms.db.bean.ReportResultDB">
  	select sum(a.qty) qty,b.dict_item_name name 
		from sm_cli_area_cover_dtl a
		left join ss_dic_item b 
		on(a.type=b.dict_item_value)
		left join sm_cli_area_cover s
		on(a.area_cover_id=s.area_cover_id)
		<where> 
                         <if test="parentAreaCode != null">
				     		s.parent_area_code=#{parentAreaCode,jdbcType=OTHER}
				     	</if>
				     	<if test="year != null">
				     		and s.year=#{year,jdbcType=OTHER}
				     	</if>
				     	<if test="month != null">
				     		and  s.month=#{month,jdbcType=OTHER}
				     	</if>
				     	 and area_flag=1
        </where>                      
               and a.source=#{Type,jdbcType=OTHER}   
               group by b.dict_item_name
  </select>
  
<!--   <select id="queryOperateOutline" parameterType="java.util.Map" resultType="com.huatuo.clinics.cms.db.bean.ReportResultDB"> -->
<!--   			select d.area_name name, b.dict_item_name type,sum(a.qty) qty -->
<!-- 		from sm_cli_area_cover_dtl a -->
<!-- 		left join ss_dic_item b  -->
<!-- 		on(a.type=b.dict_item_value) -->
<!-- 		left join sm_cli_area_cover d  -->
<!-- 		on(a.area_cover_id=d.area_cover_id) -->
<!-- 		<where> a.area_cover_id IN(select -->
<!--                            s.area_cover_id -->
<!--                          from sm_cli_area_cover s -->
<!--                          <where> -->
<!--                          <if test="parentAreaCode != null"> -->
<!-- 				     		s.parent_area_code=#{parentAreaCode,jdbcType=OTHER} -->
<!-- 				     	</if> -->
<!-- 				     	<if test="year != null"> -->
<!-- 				     		and s.year=#{year,jdbcType=OTHER} -->
<!-- 				     	</if> -->
<!-- 				     	</where> -->
<!--                              ) -->
<!--         </where>                       -->
<!--                and a.source='00049' -->
<!--                <if test="sourceCode != null"> -->
<!-- 					and a.type=#{sourceCode,jdbcType=OTHER} -->
<!-- 				</if>    -->
<!--                group by d.area_name -->
<!--                ORDER BY CONVERT(name USING gbk) ASC -->
<!--   </select> -->
  
  
  <select id="queryVisit" parameterType="java.util.Map" resultType="com.huatuo.clinics.cms.db.bean.ReportResultDB">
  			select b.dict_item_name type,a.qty qty FROM (
				select  sm.type type,sum(sm.qty) qty 
				from sm_cli_area_cover_dtl sm
				left join  sm_cli_area_cover s
				on(sm.area_cover_id=s.area_cover_id)
				<where>
						<if test="parentAreaCode != null">
							s.area_code=#{parentAreaCode,jdbcType=OTHER}
						</if>
						<if test="reportType == 'year'">
							and s.year=#{year,jdbcType=OTHER} and s.area_flag=2
						</if>
						<if test="reportType == 'month'">
							and s.year=#{year,jdbcType=OTHER} and s.month=#{month,jdbcType=OTHER}
							and s.area_flag=1
						</if>
					<if test="sourceCode != null">
					and sm.source=#{sourceCode,jdbcType=OTHER}
					</if>
					group by sm.type
				</where> 
			)a left join 
			ss_dic_item b
			on(a.type=b.dict_item_value)
  </select>
  
  <select id="querySubordinate" parameterType="java.util.Map" resultType="com.huatuo.clinics.cms.db.bean.ReportResultDB">
			select  b.area_name name,sum(a.qty) qty,c.dict_item_name type  from sm_cli_area_cover_dtl a
			left join sm_cli_area_cover  b
			on (a.area_cover_id=b.area_cover_id)
			left join ss_dic_item c
			ON(a.type=c.dict_item_value)
			<where> 
				 		<if test="parentAreaCode != null">
							b.parent_area_code=#{parentAreaCode,jdbcType=OTHER}
						</if>
						<if test="reportType == 'year'">
							and b.year=#{year,jdbcType=OTHER} and b.area_flag=2
						</if>
						<if test="reportType == 'month'">
							and b.year=#{year,jdbcType=OTHER} and b.month=#{month,jdbcType=OTHER} and b.area_flag=1
						</if>
			<if test="sourceCode != null">
					and a.source=#{sourceCode,jdbcType=OTHER}
			</if>
			</where>
			group by b.area_name,a.type
  </select>
  
  
  <select id="queryAveOutpatient" parameterType="java.util.Map" resultType="com.huatuo.clinics.cms.db.bean.ReportResultDB">
  				select  a.name name,IFNULL((CAST((b.qty1/a.qty) AS DECIMAL(9,2))),'0') qty from    
				(
				-- 各区域诊所数量
				select DISTINCT  sum(s.clinic_qty)  qty,s.area_name name from sm_cli_area_cover s 
				<where> 
						<if test="parentAreaCode != null">
							s.parent_area_code=#{parentAreaCode,jdbcType=OTHER}
						</if>
						<if test="reportType == 'year'">
							and s.year=#{year,jdbcType=OTHER} and s.area_flag=2
						</if>
						<if test="reportType == 'month'">
							and s.year=#{year,jdbcType=OTHER} and s.month=#{month,jdbcType=OTHER} and s.area_flag=1
						</if>
				 group by s.area_name
				</where>
				)a join  
				-- 各区域的门诊总量
				(select DISTINCT  sum(sm.qty) qty1,a.area_name name   from sm_cli_area_cover_dtl sm 
				left join sm_cli_area_cover a
				on(sm.area_cover_id = a.area_cover_id)
				  	<where> 
								<if test="parentAreaCode != null">
									a.parent_area_code=#{parentAreaCode,jdbcType=OTHER}
								</if>
								<if test="reportType == 'year'">
									and a.year=#{year,jdbcType=OTHER} and a.area_flag=2
								</if>
								<if test="reportType == 'month'">
									and a.year=#{year,jdbcType=OTHER} and a.month=#{month,jdbcType=OTHER} and a.area_flag=1
								</if>
					and sm.source ='00049'
					and sm.type='00049-0001'
					</where>
					group by  a.area_name
				)b
				ON (a.name=b.name)
				ORDER BY CONVERT(a.name USING gbk) ASC
  </select>
  
  
  
  <select id="queryTimeTrend" parameterType="java.util.Map" resultType="com.huatuo.clinics.cms.db.bean.ReportResultDB">
  			select a.qty qty,b.dict_item_name type,a.name name from (
			select sum(a.qty) qty,a.type type,
			if(#{reportType,jdbcType=OTHER}='year',b.year,b.month) name
			from sm_cli_area_cover_dtl a 
			left join sm_cli_area_cover b
			on (a.area_cover_id =  b.area_cover_id)
			<where> 
					<if test="parentAreaCode != null">
								b.parent_area_code=#{parentAreaCode,jdbcType=OTHER}
					</if>
					<if test="reportType == 'year'">
							and b.year&gt;=#{startYear,jdbcType=OTHER}  and  b.year&lt;=#{endYear,jdbcType=OTHER}  and b.area_flag=2
					</if>
					<if test="reportType == 'month'">
							and b.year=#{endYear,jdbcType=OTHER}  and  b.month&gt;=#{startMonth,jdbcType=OTHER} and b.month&lt;=#{endMonth,jdbcType=OTHER} and b.area_flag=1
					</if> 
			<if test="sourceCode != null">
					and a.source=#{sourceCode,jdbcType=OTHER}
			</if>
			</where>
			group by 
			<if test="reportType == 'year'">
					concat(b.year,',',a.type)
			</if>
			<if test="reportType == 'month'">
					concat(b.month,',',a.type)
			</if>
			order by  name
			)a left join 
			ss_dic_item b
			on(a.type=b.dict_item_value)
  </select>
  
    <select id="queryClQty" parameterType="java.util.Map" resultType="com.huatuo.clinics.cms.db.bean.ReportResultDB">
  			select   SUM(s.clinic_qty)  qty,s.area_name name from sm_cli_area_cover s 
				<where> 
						<if test="parentAreaCode != null">
							s.parent_area_code=#{parentAreaCode,jdbcType=OTHER}
						</if>
						<if test="reportType == 'year'">
							AND s.year=#{year,jdbcType=OTHER}  and s.area_flag=2
						</if>
						<if test="reportType == 'month'">
							AND s.year=#{year,jdbcType=OTHER} and s.month=#{month,jdbcType=OTHER} and s.area_flag=1
						</if>
				</where>
				group by s.area_name
  </select>
  
  <select id="querySum" parameterType="java.util.Map" resultType="com.huatuo.clinics.cms.db.bean.ReportResultDB">
  			select   sum(sm.qty) qty,a.area_name name   from sm_cli_area_cover_dtl sm 
			left join sm_cli_area_cover a
			ON(sm.area_cover_id = a.area_cover_id)
			  <where>
						<if test="parentAreaCode != null">
							a.parent_area_code=#{parentAreaCode,jdbcType=OTHER}
						</if>
						<if test="reportType == 'year'">
							and a.year=#{year,jdbcType=OTHER}  and a.area_flag=2
						</if>
						<if test="reportType == 'month'">
							and a.year=#{year,jdbcType=OTHER} and a.month=#{month,jdbcType=OTHER} and a.area_flag=1
						</if>
				and sm.source ='00049'and sm.type ='00049-0001'
				</where>
				group by a.area_name
  			
  </select>
  
  <select id="queryFirstVisit" parameterType="java.util.Map" resultType="com.huatuo.clinics.cms.db.bean.ReportResultDB">
  		select b.area_name name,sum(sm.qty) qty  from sm_cli_area_cover_dtl sm 
			left join sm_cli_area_cover b
			on (sm.area_cover_id = b.area_cover_id)
			<where> 
						<if test="parentAreaCode != null">
							b.parent_area_code=#{parentAreaCode,jdbcType=OTHER}
						</if>
						<if test="reportType == 'year'">
							and b.year=#{year,jdbcType=OTHER} and b.area_flag=2
						</if>
						<if test="reportType == 'month'">
							and b.year=#{year,jdbcType=OTHER} and b.month=#{month,jdbcType=OTHER} and b.area_flag=1
						</if>
			and sm.source ='00044'  and sm.type='00044-0001'
			</where>
			group by b.area_name,sm.type
  </select>
  
  <select id="queryRepeatVisit" parameterType="java.util.Map" resultType="com.huatuo.clinics.cms.db.bean.ReportResultDB">
  		select b.area_name name,sum(sm.qty) qty  from sm_cli_area_cover_dtl sm 
			left join sm_cli_area_cover b
			on (sm.area_cover_id = b.area_cover_id)
			<where> 
						<if test="parentAreaCode != null">
							b.parent_area_code=#{parentAreaCode,jdbcType=OTHER}
						</if>
						<if test="reportType == 'year'">
							and b.year=#{year,jdbcType=OTHER} and b.area_flag=2
						</if>
						<if test="reportType == 'month'">
							and b.year=#{year,jdbcType=OTHER} and b.month=#{month,jdbcType=OTHER} and b.area_flag=1
						</if>
			and sm.source ='00044'  and sm.type='00044-0002'
			</where>
			group by b.area_name,sm.type
  </select>
  
  <select id="queryWestVisit" parameterType="java.util.Map" resultType="com.huatuo.clinics.cms.db.bean.ReportResultDB">
  			select b.area_name name,sum(sm.qty) qty  from sm_cli_area_cover_dtl sm 
			left join sm_cli_area_cover b
			on (sm.area_cover_id = b.area_cover_id)
			<where> 
						<if test="parentAreaCode != null">
							b.parent_area_code=#{parentAreaCode,jdbcType=OTHER}
						</if>
						<if test="reportType == 'year'">
							and b.year=#{year,jdbcType=OTHER} and b.area_flag=2
						</if>
						<if test="reportType == 'month'">
							and b.year=#{year,jdbcType=OTHER} and b.month=#{month,jdbcType=OTHER} and b.area_flag=1
						</if>
				 and sm.source ='00051' and sm.type='00051-0001'
			</where>	 
			group by b.area_name,sm.type
  </select>
  
  <select id="queryInVisit" parameterType="java.util.Map" resultType="com.huatuo.clinics.cms.db.bean.ReportResultDB">
  			select b.area_name name,sum(sm.qty) qty  from sm_cli_area_cover_dtl sm 
			left join sm_cli_area_cover b
			on (sm.area_cover_id = b.area_cover_id)
			<where> 
						<if test="parentAreaCode != null">
							b.parent_area_code=#{parentAreaCode,jdbcType=OTHER}
						</if>
						<if test="reportType == 'year'">
							and b.year=#{year,jdbcType=OTHER} and b.area_flag=2
						</if>
						<if test="reportType == 'month'">
							and b.year=#{year,jdbcType=OTHER} and b.month=#{month,jdbcType=OTHER} and b.area_flag=1
						</if>
					and sm.source ='00051' and sm.type='00051-0002'
			</where>		
			group by b.area_name,sm.type
  </select>
  
  <select id="queryServiceQty" parameterType="java.util.Map" resultType="com.huatuo.clinics.cms.db.bean.ReportResultDB">
			select IF(#{reportType,jdbcType=OTHER}='year',b.year,b.month) as name,
  			sum(sm.qty) qty,c.dict_item_name type   
  			from sm_cli_area_cover_dtl sm 
			left join sm_cli_area_cover b
			on (sm.area_cover_id = b.area_cover_id)
			left join ss_dic_item c 
			ON(sm.type=c.dict_item_value)
			<where> 
						<if test="parentAreaCode != null">
							b.area_code=#{parentAreaCode,jdbcType=OTHER}
						</if>
						<if test=" reportType== 'year'">
							and b.year=#{year,jdbcType=OTHER} and b.area_flag=2
						</if>
						<if test=" reportType== 'month'">
							and b.year=#{year,jdbcType=OTHER} and b.month=#{month,jdbcType=OTHER} and b.area_flag=1
						</if>
					and sm.source ='00049' and sm.type='00049-0002'
			</where>
			group by b.year,sm.type
  </select>
  
  
  <select id="queryServiceEff" parameterType="java.util.Map" resultType="com.huatuo.clinics.cms.db.bean.ReportResultDB">
  		select  IFNULL(SUM(sm.qty),'0') qty ,
  		c.dict_item_name name
  		  from sm_cli_area_cover_dtl sm 
			left join sm_cli_area_cover b
			ON (sm.area_cover_id = b.area_cover_id)
			left join ss_dic_item c
			ON(sm.type=c.dict_item_value)
			<where> 
							<if test="parentAreaCode != null">
							b.area_code=#{parentAreaCode,jdbcType=OTHER}
							</if>
							<if test="reportType == 'year' ">
								and b.year=#{year,jdbcType=OTHER} and b.area_flag=2
							</if>
							<if test="reportType == 'month' ">
								and b.year=#{year,jdbcType=OTHER} and b.month=#{month,jdbcType=OTHER} and b.area_flag=1
							</if>
							and sm.source =#{code,jdbcType=OTHER} 
			</where>	
			group by sm.type
  </select>
  
  <select id="queryJunior" parameterType="java.util.Map" resultType="com.huatuo.clinics.cms.db.bean.ReportResultDB">
				select  b.area_name name,SUM(a.qty) qty,c.dict_item_name type  from sm_cli_area_cover_dtl a
					left join sm_cli_area_cover  b
					on (a.area_cover_id=b.area_cover_id)
					left join 
					ss_dic_item c
					on(a.type=c.dict_item_value)
					<where> 
						 		<if test="parentAreaCode != null">
									b.parent_area_code=#{parentAreaCode,jdbcType=OTHER}
								</if>
								<if test="reportType == 'year'">
									and b.year=#{year,jdbcType=OTHER} and b.area_flag=2
								</if>
								<if test="reportType == 'month'">
									and b.year=#{year,jdbcType=OTHER} and  b.month=#{month,jdbcType=OTHER} and b.area_flag=1
								</if>
					<if test="code != null">
							and a.source=#{code,jdbcType=OTHER}
					</if>
					</where>
					group by b.area_name,a.type
					ORDER BY CONVERT(b.area_name USING gbk) ASC,CONVERT(c.dict_item_name USING gbk) ASC
  </select>
  
  <select id="queryCostQty" parameterType="java.util.Map" resultType="com.huatuo.clinics.cms.db.bean.ReportResultDB">
  		select IF(#{reportType,jdbcType=OTHER}='year',b.year,b.month) name,
  			sum(sm.qty) qty  
  			from sm_cli_area_cover_dtl sm 
			left join sm_cli_area_cover b
			on (sm.area_cover_id = b.area_cover_id)
			<where> 
						<if test="parentAreaCode != null">
							b.area_code=#{parentAreaCode,jdbcType=OTHER}
						</if>
						<if test="reportType == 'year'">
							and b.year=#{year,jdbcType=OTHER} and b.area_flag=2
						</if>
						<if test="reportType == 'month'">
							and b.year=#{year,jdbcType=OTHER}  and b.month=#{month,jdbcType=OTHER} and b.area_flag=1
						</if>
					and sm.source ='00049' and sm.type='00049-0003'
			</where>
			group by b.year,sm.type
  </select>
	
  <select id="queryCostType" parameterType="java.util.Map" resultType="com.huatuo.clinics.cms.db.bean.ReportResultDB">
  		select  IFNULL((CAST((SUM(sm.qty)/COUNT(sm.area_cover_id)) AS DECIMAL(9,2))),'0') qty ,
  			c.dict_item_name name
  		  	from sm_cli_area_cover_dtl sm 
			left join sm_cli_area_cover b
			ON (sm.area_cover_id = b.area_cover_id)
			left join ss_dic_item c
			ON(sm.type=c.dict_item_value)
			<where> 
							<if test="parentAreaCode != null">
								b.area_code=#{parentAreaCode,jdbcType=OTHER}
							</if>
							<if test="reportType == 'year'">
							and b.year=#{year,jdbcType=OTHER} and b.area_flag=2
							</if>
							<if test="reportType == 'month'">
								and b.year=#{year,jdbcType=OTHER}  and b.month=#{month,jdbcType=OTHER} and b.area_flag=1
							</if>
					<if test="code != null">
						and sm.source =#{code,jdbcType=OTHER}
					</if>
			</where>	
					group by sm.type
  </select>  
  
  
<!--  暂不用  -->
<!--   <select id="queryLower" parameterType="java.util.Map" resultType="com.huatuo.clinics.cms.db.bean.ReportResultDB"> -->
<!--   			select a.name name,a.qty qty,b.dict_item_name type from ( -->
<!-- 			select  b.area_name name,SUM(a.qty) qty,a.type type  from sm_cli_area_cover_dtl a -->
<!-- 			left join sm_cli_area_cover  b -->
<!-- 			on (a.area_cover_id=b.area_cover_id) -->
<!-- 			<where>  -->
<!-- 			a.area_cover_id in ( -->
<!-- 				select   s.area_cover_id  from sm_cli_area_cover  s  -->
<!-- 				 <where> -->
<!-- 				 		<if test="parentAreaCode != null"> -->
<!-- 							s.parent_area_code=#{parentAreaCode,jdbctype=OTHER} -->
<!-- 						</if> -->
<!-- 						<if test="reporttype != null"> -->
<!-- 							and s.year=#{year,jdbctype=OTHER} -->
<!-- 						</if> -->
<!-- 				 </where> -->
<!-- 					)		   -->
<!-- 					and a.source='00049' -->
<!-- 					and a.type='00049-0002' -->
<!-- 			</where> -->
<!-- 			group by b.area_name -->
<!-- 			)a left join  -->
<!-- 			ss_dic_item b -->
<!-- 			on(a.type=b.dict_item_value) -->
<!--   </select> -->
  
  <select id="queryQuality" parameterType="java.util.Map" resultType="java.lang.String">
  			select  sum(a.qty) qty from sm_cli_area_cover_dtl a
			left join sm_cli_area_cover  b
			on (a.area_cover_id=b.area_cover_id)
			<where> 
                         <if test="parentAreaCode != null">
				     		b.parent_area_code=#{parentAreaCode,jdbcType=OTHER}
				     	</if>
				     	<if test="year != null">
				     		and b.year=#{year,jdbcType=OTHER}
				     	</if>
				     	<if test="month != null">
				     		and  b.month=#{month,jdbcType=OTHER}
				     	</if>
				     	<if test="day != null">
				     		and b.day&lt;=#{day,jdbcType=OTHER}
				     	</if>
				<if test="code != null">
				     and a.source=#{code,jdbcType=OTHER}
				</if>	 
				<if test="type != null">
				     and  a.type=#{type,jdbcType=OTHER}
				</if> 
			</where>
			group by a.type
  </select>
  
   <select id="queryReIncidence" parameterType="java.util.Map" resultType="com.huatuo.clinics.cms.db.bean.ReportResultDB">
  		select sum(a.qty) qty,b.sickness_name name
		from sm_cli_area_cover_dtl a
		left join sm_cli_area_sickness_info b
		on(a.area_cover_id=b.area_cover_id and a.source= b.source)
		left join sm_cli_area_cover s
		on(s.area_cover_id=a.area_cover_id)
			<where>
				     		<if test="parentAreaCode != null">
				     		s.area_code=#{parentAreaCode,jdbcType=OTHER}
					     	</if>
					     	<if test="reportType == 'year'">
					     		and s.year=#{year,jdbcType=OTHER}  and s.area_flag=2
					     	</if>
					     	<if test="reportType == 'month'">
					     		and s.year=#{year,jdbcType=OTHER} and s.month=#{month,jdbcType=OTHER} and s.area_flag=1
					     	</if>
                and a.source IN('00068','00069','00070','00071','00072','00073','00074','00075','00076','00077')          
		</where>
		group by a.source
		order by qty desc
  </select>
  
  
  <select id="queryReIncidenceSum" parameterType="java.util.Map" resultType="java.lang.String">
  		select sum(a.qty) qty
		from sm_cli_area_cover_dtl a
		left join sm_cli_area_cover s
		on(s.area_cover_id=a.area_cover_id)
			<where>
                         <if test="parentAreaCode != null">
				     		s.area_code=#{parentAreaCode,jdbcType=OTHER}
				     	</if>
				     	<if test="reportType == 'year'">
				     		and s.year=#{year,jdbcType=OTHER}    and s.area_flag=2
				     	</if>
				     	<if test="reportType == 'month'">
				     		and s.year=#{year,jdbcType=OTHER}  and s.month=#{month,jdbcType=OTHER}  and s.area_flag=1
				     	</if>
                			and a.type ='00049-0001'          
			</where> 
  </select>
  
  
   <select id="queryReGiven" parameterType="java.util.Map" resultType="com.huatuo.clinics.cms.db.bean.ReportResultDB">
  		select sum(a.qty) qty,b.sickness_name name
		from sm_cli_area_cover_dtl a
		left join sm_cli_area_sickness_info b
		on(a.area_cover_id=b.area_cover_id and a.source= b.source)
		left join sm_cli_area_cover s
		on(s.area_cover_id=a.area_cover_id)
			<where>
				     		<if test="parentAreaCode != null">
				     			s.area_code=#{parentAreaCode,jdbcType=OTHER}
					     	</if>
					     	<if test="reportType == 'year'">
				     			and s.year=#{year,jdbcType=OTHER}    and s.area_flag=2
					     	</if>
					     	<if test="reportType == 'month'">
					     		and s.year=#{year,jdbcType=OTHER}  and s.month=#{month,jdbcType=OTHER}  and s.area_flag=1
					     	</if>
                				and a.source =#{code,jdbcType=OTHER}       
		</where>
							group by a.source
  </select>
  
  
  <select id="Information"  parameterType="com.huatuo.clinics.cms.bean.RuquestBeanDTO"  resultType="HashMap">
select * from (select smcl.area_code, smcl.area_name, smacd.source, sdt.dict_type_name, smacd.type, smacd.qty qty, sdi.dict_item_name
from (select area_code, area_name, area_cover_id
				from sm_cli_area_cover
				where area_flag=${areaFlag} 
						<if test="year != null">
				     		and year=#{year,jdbcType=OTHER}
				     	</if>
				     	<if test="month != null">
				     		and  month=#{month,jdbcType=OTHER}
				     	</if>
				     	<if test="day != null">
				     		and day=#{day,jdbcType=OTHER}
				     	</if>
				     	 and #{startTime,jdbcType=OTHER}>=(select date_format(CONCAT(sm2.`year`,'-',IFNULL(sm2.`month`, '00'),'-',IFNULL(sm2.`day`,'00')),'%Y-%m-%d') from sm_cli_area_cover sm2 
where sm2.area_cover_id=sm_cli_area_cover.area_cover_id)
				and parent_area_code = #{parentAreaCode,jdbcType=OTHER}) smcl
LEFT JOIN (select area_cover_id,source, qty, type 
						from sm_cli_area_cover_dtl
						where source
						in(00040, 00041, 00042, 00043)) smacd 
on (smcl.area_cover_id = smacd.area_cover_id)
LEFT JOIN ss_dic_item sdi
on (smacd.type = sdi.dict_item_code)
LEFT JOIN ss_dic_type sdt
on (smacd.source = sdt.dict_type_code)
GROUP BY smcl.area_code, smacd.source, smacd.type
ORDER BY smcl.area_code, smacd.source, smacd.type)a LEFT JOIN
(select clinic_qty clinic_qty,area_code
				from sm_cli_area_cover
				where area_flag=${areaFlag} 
						<if test="year != null">
				     		and year=#{year,jdbcType=OTHER}
				     	</if>
				     	<if test="month != null">
				     		and  month=#{month,jdbcType=OTHER}
				     	</if>
				     	<if test="day != null">
				     		and day=#{day,jdbcType=OTHER}
				     	</if>
				and  #{startTime,jdbcType=OTHER}>=(select date_format(CONCAT(sm2.`year`,'-',IFNULL(sm2.`month`, '00'),'-',IFNULL(sm2.`day`,'00')),'%Y-%m-%d') from sm_cli_area_cover sm2 
where sm2.area_cover_id=sm_cli_area_cover.area_cover_id)
				and parent_area_code = #{parentAreaCode,jdbcType=OTHER}
				GROUP BY area_code)b
on(a.area_code=b.area_code)
order by convert(area_name using gbk) asc;
  </select>
  <select id="administrativeJson"  parameterType="com.huatuo.clinics.cms.bean.RuquestBeanDTO" resultType="com.huatuo.clinics.cms.db.bean.ReportResultDB">
  select sum(s.clinic_qty) qty,s.area_name as name from sm_cli_area_cover s
  				 WHERE s.parent_area_code=#{parentAreaCode,jdbcType=OTHER}
				     		and  area_flag=${areaFlag}and  #{startTime,jdbcType=OTHER}>=(select date_format(CONCAT(sm2.`year`,'-',sm2.`month`,'-',IFNULL(sm2.`day`,'00')),'%Y-%m-%d') from sm_cli_area_cover sm2 
where sm2.area_cover_id=s.area_cover_id)
										GROUP BY s.area_code
										order by convert(area_name using gbk) asc;
  </select>
  <select id="timeseries" parameterType="com.huatuo.clinics.cms.bean.RuquestBeanDTO" resultType="com.huatuo.clinics.cms.bean.ReportResult2DTO">
  SELECT IFNULL(sum(sm.clinic_qty),"0") as qty
		from sm_cli_area_cover sm 
			where sm.parent_area_code=#{parentAreaCode,jdbcType=OTHER}
			and sm.`year` = #{year,jdbcType=OTHER}
			<if test="month != null">
					and sm.`month` =#{month,jdbcType=OTHER}
			</if>
			and sm.area_flag=${areaFlag} 
  </select>
  <select id="areaPopulationStation" parameterType="com.huatuo.clinics.cms.bean.RuquestBeanDTO" resultType="com.huatuo.clinics.cms.bean.mrcDTO">
  SELECT sum(sm.doctor_qty) dctorQty,sum(sm.nurse_qty) nurseQty,sum(sm.other_qty) otherQty FROM sm_cli_area_cover sm
where sm.parent_area_code=#{parentAreaCode,jdbcType=OTHER} 
							<if test="startTime != null">
				     		and area_flag=${areaFlag} and #{startTime,jdbcType=OTHER}>=(select date_format(CONCAT(sm2.`year`,'-',IFNULL(sm2.`month`,'00'),'-',IFNULL(sm2.`day`,'00')),'%Y-%m-%d') from sm_cli_area_cover sm2 
							where sm2.area_cover_id=sm.area_cover_id)
				     	</if>
GROUP BY sm.parent_area_code
  </select>
  <select id="areaDoctorTitle" parameterType="com.huatuo.clinics.cms.bean.RuquestBeanDTO" resultType="com.huatuo.clinics.cms.bean.ReportResultDTO">
SELECT sum(scacd.qty) qty,case type 
			when '00048-0001' then '初级' 
			when '00048-0002' then '中级'
			when '00048-0003' then '高级' END as type
from sm_cli_area_cover scac
		LEFT JOIN sm_cli_area_cover_dtl scacd
				on(scac.area_cover_id = scacd.area_cover_id)
				where 1=1
					and scac.parent_area_code = #{parentAreaCode,jdbcType=OTHER} 
					and scac.area_flag = ${areaFlag}
					and scac.year &lt;=  #{year,jdbcType=OTHER}
					<if test="month != null">
					and (scac.`year` &lt; #{year,jdbcType=OTHER} or scac.`month` &lt;=#{month,jdbcType=OTHER})
					</if>
					and scacd.source=00048
					GROUP BY scacd.type
  </select>
  <select id="PositionDistribution" parameterType="com.huatuo.clinics.cms.bean.RuquestBeanDTO" resultType="HashMap">
select sm.area_name,sum(sm.doctor_qty)  as doctor,sum(sm.nurse_qty) nurse ,sum(sm.other_qty)  other from sm_cli_area_cover sm 
where sm.parent_area_code=#{parentAreaCode,jdbcType=OTHER} and sm.`year`  =  #{year,jdbcType=OTHER} and sm.area_flag = ${areaFlag}
					<if test="month != null">
					and sm.`month` =#{month,jdbcType=OTHER}
					</if>
GROUP BY area_code
order by convert(area_name using gbk) asc;
  </select>
    <select id="DoctorTitle" parameterType="com.huatuo.clinics.cms.bean.RuquestBeanDTO" resultType="HashMap">
				 select sm.area_code,sm.area_name, sum(qty) as qty,case type 
							when '00048-0001' then '初级' 
							when '00048-0002' then '中级'
							when '00048-0003' then '高级' END as type
							from sm_cli_area_cover_dtl dtl RIGHT JOIN (
							select * from sm_cli_area_cover sm 
									where sm.parent_area_code=#{parentAreaCode,jdbcType=OTHER} 
									and sm.`year` &lt;= #{year,jdbcType=OTHER} and sm.area_flag = ${areaFlag}
									<if test="month != null">
									and (sm.`year` &lt; #{year,jdbcType=OTHER}  or sm.`month` &lt;=#{month,jdbcType=OTHER})
									</if>
							)sm on(sm.area_cover_id=dtl.area_cover_id)
							 where dtl.source=00048 
							GROUP BY sm.area_name,dtl.type
							order by convert(area_name using gbk) asc;
  </select>
  <select id="selectTotal"  parameterType="com.huatuo.clinics.cms.bean.RuquestBeanDTO" resultMap="BaseResultMap">
<!--   	  				select * from sm_cli_area_cover s -->
<!--   				<where> -->
<!--                          <if test="parentAreaCode != null"> -->
<!-- 				     		s.parent_area_code=#{parentAreaCode,jdbcType=OTHER} -->
<!-- 				     	</if> -->
<!-- 				     	<if test="areaCode != null"> -->
<!-- 				     		and  s.area_code=#{areaCode,jdbcType=OTHER} -->
<!-- 				     	</if> -->
<!-- 				     	<if test="startTime != null"> -->
<!-- 				     		and #{startTime,jdbcType=OTHER}>=(select date_format(CONCAT(sm2.`year`,'-',sm2.`month`,'-',IFNULL(sm2.`day`,'00')),'%Y-%m-%d') from sm_cli_area_cover sm2  -->
<!-- where sm2.area_cover_id=s.area_cover_id) -->
<!-- 				     	</if> -->
<!-- 				     	AND 1>(SELECT COUNT(*) FROM sm_cli_area_cover WHERE s.area_code=area_code AND record_date>s.record_date); -->
<!-- 				     	</where> -->
		SELECT * FROM sm_cli_area_cover s 
		<where>
		s.parent_area_code=#{parentAreaCode,jdbcType=OTHER} 
		and s.area_flag = ${areaFlag}
									and s.`year` = #{year,jdbcType=OTHER}
									<if test="month != null">
									and s.`month` =#{month,jdbcType=OTHER}
									</if>
		</where>
  </select>
  <select id="queryTypeTotal" parameterType="com.huatuo.clinics.cms.bean.RuquestBeanDTO"  resultType="com.huatuo.clinics.cms.db.bean.ReportResultDB">
  	select sum(a.qty) qty,b.dict_item_name name 
		from sm_cli_area_cover_dtl a
		left join ss_dic_item b 
		on(a.type=b.dict_item_value)
		<where> a.area_cover_id IN(select
                           s.area_cover_id
                         from sm_cli_area_cover s
                         <where>
                         <if test="parentAreaCode != null">
				     		s.parent_area_code=#{parentAreaCode,jdbcType=OTHER}
				     	</if>
				     	and s.`year` =#{year,jdbcType=OTHER} and s.area_flag =${areaFlag}
					<if test="month != null">
						 and 	s.`month` =#{month,jdbcType=OTHER}
					</if>
				     	</where>
                             )
        </where>                      
               and a.source=#{Type,jdbcType=OTHER}   
               group by b.dict_item_name
               ORDER BY type asc
  </select>
  <select id="headcountAvg" parameterType="com.huatuo.clinics.cms.bean.RuquestBeanDTO" resultType="HashMap">
  	select area_name,	IFNULL(ROUND((doctor_qty + nurse_qty + other_qty)/ clinic_qty,1	),0) avg,
 IFNULL(ROUND(doctor_qty/(nurse_qty),1),'0') AS mcr
from sm_cli_area_cover sm where sm.parent_area_code=#{parentAreaCode,jdbcType=OTHER} 
 and sm.`year` = #{year,jdbcType=OTHER}  and sm.area_flag = ${areaFlag}
 									<if test="month != null">
									and sm.`month` =#{month,jdbcType=OTHER}
									</if>
GROUP BY area_code
order by convert(area_name using gbk) asc;
  </select>
  <select id="doctorAbility"  parameterType="com.huatuo.clinics.cms.bean.RuquestBeanDTO" resultType="HashMap">
			select sm.area_name,area_code,IFNULL(ROUND(sum(doctor_qty)/sum(clinic_qty),1),0) doctor,
			IFNULL(ROUND(low/sum(clinic_qty),1),0) low,
			IFNULL(ROUND(mid/sum(clinic_qty),1),0) mid,
			IFNULL(ROUND(high/sum(clinic_qty),1),0) high
			from sm_cli_area_cover sm   
			LEFT JOIN (select area_name,sum(low) low,sum(mid) mid,sum(high) high  from(select area_name,
											IFNULL(case type when '00048-0001' then qty end,0) as 'low',
											IFNULL(case type when '00048-0002' then qty end,0) as 'mid',
											IFNULL(case type when '00048-0003' then qty end,0) as 'high'
											 from (
											 select sm.area_name, sum(qty) as qty,type
														from sm_cli_area_cover_dtl dtl LEFT JOIN (
														select * from sm_cli_area_cover sm where sm.parent_area_code=#{parentAreaCode,jdbcType=OTHER}
														and sm.`year` &lt;= #{year,jdbcType=OTHER} and sm.area_flag = ${areaFlag}
														<if test="month != null">
														and (sm.`year` &lt; #{year,jdbcType=OTHER}  or sm.`month` &lt;=#{month,jdbcType=OTHER})
														</if>
														)sm on(sm.area_cover_id=dtl.area_cover_id)
														 where dtl.source=00048 
														GROUP BY sm.area_name,dtl.type)data
											GROUP BY area_name, type)a
							GROUP BY area_name
				)a on(a.area_name=sm.area_name)
			where sm.parent_area_code=#{parentAreaCode,jdbcType=OTHER}
			and sm.`year` &lt;= #{year,jdbcType=OTHER}
			and (sm.`year` &lt; #{year,jdbcType=OTHER} or sm.`month` &lt;=#{month,jdbcType=OTHER})
			group by sm.area_name
			order by convert(sm.area_name using gbk) asc;
  </select>
  <!--个体诊所人员构成信息总表 -->
  <select id="PersonnelForm"  parameterType="com.huatuo.clinics.cms.bean.RuquestBeanDTO" resultType="HashMap">
				select sm.area_name,CONCAT(IFNULL(ROUND(doctor_qty/sm.nurse_qty,1),0),'') mrc,
					doctor_qty+nurse_qty+other_qty count,doctor_qty doctor_qty,nurse_qty nurse_qty,other_qty other_qty,
						IFNULL(a.high,0) as high,IFNULL(a.mid,0) as mid,IFNULL(a.low,0) as low,
					IFNULL(ROUND((doctor_qty+nurse_qty+other_qty)/clinic_qty,1),0) as avg
					from sm_cli_area_cover sm  left join(
					select area_name,sum(low) low,sum(mid) mid,sum(high) high  from(select area_name,
																IFNULL(case type when '00048-0001' then qty end,0) as 'low',
																IFNULL(case type when '00048-0002' then qty end,0) as 'mid',
																IFNULL(case type when '00048-0003' then qty end,0) as 'high'
																 from (
																 select sm.area_name, sum(qty) as qty,type
																			from sm_cli_area_cover_dtl dtl LEFT JOIN (
																			select * from sm_cli_area_cover sm where sm.parent_area_code=#{parentAreaCode,jdbcType=OTHER} 
																			and sm.`year` &lt;=#{year,jdbcType=OTHER} and sm.area_flag = ${areaFlag}
																			<if test="month != null">
																				and (sm.`year` &lt; #{year,jdbcType=OTHER}  or sm.`month` &lt;=#{month,jdbcType=OTHER})
																				</if>
																			)sm on(sm.area_cover_id=dtl.area_cover_id)
																			 where dtl.source=00048 
																			GROUP BY sm.area_name,dtl.type)data
																GROUP BY area_name, type)a
												GROUP BY area_name
									)a on(a.area_name=sm.area_name)
					where sm.parent_area_code=#{parentAreaCode,jdbcType=OTHER} 
					and sm.`year` =#{year,jdbcType=OTHER} and sm.area_flag =${areaFlag}
					<if test="month != null">
						 and 	sm.`month` =#{month,jdbcType=OTHER}
					</if>
					GROUP BY sm.area_code
					order by convert(sm.area_name using gbk) asc;
  </select>
  <select id="timeseriesPerson" parameterType="com.huatuo.clinics.cms.bean.RuquestBeanDTO" resultType="HashMap">
  	select IFNULL(sum(doctor_qty+nurse_qty+other_qty),0) qty,
		IFNULL(sum(doctor_qty),0) doctor_qty, 
		IFNULL(sum(nurse_qty),0)  nurse_qty,
		IFNULL(sum(other_qty),0) other_qty,
		IFNULL(ROUND(sum(doctor_qty)/sum(sm.nurse_qty),1),0) as mcr
 		from sm_cli_area_cover sm 
		where sm.`year` &lt;= #{year,jdbcType=OTHER}  and sm.area_flag = ${areaFlag}
				<if test="month != null">
				     		and (sm.`year` &lt; #{year,jdbcType=OTHER} or sm.`month` &lt;=#{month,jdbcType=OTHER})
				</if>		
		 and sm.parent_area_code=#{parentAreaCode,jdbcType=OTHER} 
  </select>
  <select id="antibioticUse" parameterType="com.huatuo.clinics.cms.bean.RuquestBeanDTO" resultType="HashMap">
  		SELECT a.qty qty,b.dict_item_name,datas FROM (
			SELECT sum(a.qty) qty, a.type,
			  CASE #{areaFlag,jdbcType=OTHER}  WHEN '2' THEN  CONCAT(#{year,jdbcType=OTHER},'年') WHEN '1' THEN  CONCAT(#{year,jdbcType=OTHER},'年',#{month,jdbcType=OTHER},'月') ELSE CONCAT(#{year,jdbcType=OTHER},'年',#{month,jdbcType=OTHER},'月',#{day,jdbcType=OTHER},'日') END datas
			  FROM sm_cli_area_cover_dtl a 
			  WHERE a.area_cover_id IN (
			  SELECT s.area_cover_id FROM sm_cli_area_cover s WHERE s.parent_area_code=#{parentAreaCode,jdbcType=OTHER}  and s.area_flag=${areaFlag}
			 			 <if test="year != null">
					     		 and s.year=#{year,jdbcType=OTHER}
					     </if>
						 <if test="month != null">
					     		 and s.month=#{month,jdbcType=OTHER}
					     </if>
					     <if test="day != null">
					     		 and s.day=#{day,jdbcType=OTHER}
					     </if>
			 )
			  AND a.source='00046' 
			  and a.type in ('00046-0001','00046-0004')
			  GROUP BY a.type
			)a LEFT JOIN 
			ss_dic_item b
			ON(a.TYPE=b.dict_item_value)
  </select>
  <select id="transfusion"  parameterType="com.huatuo.clinics.cms.bean.RuquestBeanDTO" resultType="com.huatuo.clinics.cms.bean.ReportResult2DTO">
  SELECT a.qty qty,b.dict_item_name type,a.datas Date FROM (
		SELECT SUM(a.qty) qty, a.type, 
		  CASE #{areaFlag,jdbcType=OTHER}  WHEN '2' THEN  CONCAT(#{year,jdbcType=OTHER},'年') WHEN '1' THEN  CONCAT(#{year,jdbcType=OTHER},'年',#{month,jdbcType=OTHER},'月') ELSE CONCAT(#{year,jdbcType=OTHER},'年',#{month,jdbcType=OTHER},'月',#{day,jdbcType=OTHER},'日') END datas
		 			 FROM sm_cli_area_cover_dtl a 
		  					WHERE a.area_cover_id IN (
		  							SELECT s.area_cover_id FROM sm_cli_area_cover s WHERE s.parent_area_code=#{parentAreaCode,jdbcType=OTHER}  and s.area_flag=#{areaFlag,jdbcType=OTHER}
			 			 <if test="year != null">
					     		 and s.year=#{year,jdbcType=OTHER}
					     </if>
						 <if test="month != null">
					     		 and s.month=#{month,jdbcType=OTHER}
					     </if>
					     <if test="day != null">
					     		 and s.day=#{day,jdbcType=OTHER}
					     </if>
						 )
		   	 AND a.source='00046' 
		   	 and a.type in ('00046-0002','00046-0003','00046-0004')
		  GROUP BY a.type
		  )a LEFT JOIN 
		ss_dic_item b
ON(a.TYPE=b.dict_item_value)  
  </select>
  <select id="antibioticTransfusion"   parameterType="com.huatuo.clinics.cms.bean.RuquestBeanDTO" resultType="com.huatuo.clinics.cms.db.bean.ReportResultDB">
    SELECT a.qty qty,b.dict_item_name type,a.datas name FROM (
		SELECT SUM(a.qty) qty, a.type, 
		  CASE #{reportType,jdbcType=OTHER}  WHEN 'year'
		  		THEN CONCAT(#{year,jdbcType=OTHER},'年')
		  		ELSE CONCAT(#{year,jdbcType=OTHER},'年',#{month,jdbcType=OTHER},'月') END datas
		 			 FROM sm_cli_area_cover_dtl a 
		  					WHERE a.area_cover_id IN (
		  							SELECT s.area_cover_id FROM sm_cli_area_cover s WHERE s.parent_area_code=#{parentAreaCode,jdbcType=OTHER} 
		  								 AND s.year=#{year,jdbcType=OTHER}  AND   IF(#{reportType,jdbcType=OTHER}='year' ,'1=1',s.month=#{month,jdbcType=OTHER})
						 )
		   	 AND a.source='00046' 
		  GROUP BY a.type
		  )a LEFT JOIN 
		ss_dic_item b
ON(a.TYPE=b.dict_item_value)  
  </select>
  <select id="roportionAntibioticUse"  parameterType="com.huatuo.clinics.cms.bean.RuquestBeanDTO" resultType="com.huatuo.clinics.cms.db.bean.ReportResultDB">
  	select area_name name,CONCAT(IFNULL(CAST(sum(q)/(sum(w))*100 AS DECIMAL(8,1)),0),'%') qty from (SELECT  a.area_name,
		ifnull(CASE type WHEN '00046-0001' THEN qty END,0) AS 'q',
		ifnull(CASE type WHEN '00046-0004' THEN qty END,0) AS 'w' FROM (
			SELECT SUM(a.qty) qty,a.type,b.area_name
				FROM sm_cli_area_cover_dtl a 
					LEFT JOIN sm_cli_area_cover b
						ON(a.area_cover_id = b.area_cover_id)
								WHERE a.area_cover_id IN (			  SELECT s.area_cover_id FROM sm_cli_area_cover s WHERE s.parent_area_code=#{parentAreaCode,jdbcType=OTHER}  and s.area_flag=#{areaFlag,jdbcType=OTHER}
			 			 <if test="year != null">
					     		 and s.year=#{year,jdbcType=OTHER}
					     </if>
						 <if test="month != null">
					     		 and s.month=#{month,jdbcType=OTHER}
					     </if>
					     <if test="day != null">
					     		 and s.day=#{day,jdbcType=OTHER}
					     </if>
								) AND a.source='00046' 
					GROUP BY  b.area_code,a.type
		    )a
	GROUP BY area_name,type
)data GROUP BY area_name
order by convert(area_name using gbk) asc;
  </select>
  <select id="transfusionPrescriptions"  parameterType="com.huatuo.clinics.cms.bean.RuquestBeanDTO" resultType="com.huatuo.clinics.cms.db.bean.ReportResultDB">
    	select area_name name,CONCAT(IFNULL(CAST(sum(q)/(sum(w))*100 AS DECIMAL(8,1)),0),'%') qty from (SELECT  a.area_name,
		ifnull(CASE type WHEN '00046-0002' THEN qty END,0) AS 'q',
		ifnull(CASE type WHEN '00046-0004' THEN qty END,0) AS 'w' FROM (
			SELECT SUM(a.qty) qty,a.type,b.area_name
				FROM sm_cli_area_cover_dtl a 
					LEFT JOIN sm_cli_area_cover b
						ON(a.area_cover_id = b.area_cover_id)
								WHERE a.area_cover_id IN (			  SELECT s.area_cover_id FROM sm_cli_area_cover s WHERE s.parent_area_code=#{parentAreaCode,jdbcType=OTHER}  and s.area_flag=#{areaFlag,jdbcType=OTHER}
			 			 <if test="year != null">
					     		 and s.year=#{year,jdbcType=OTHER}
					     </if>
						 <if test="month != null">
					     		 and s.month=#{month,jdbcType=OTHER}
					     </if>
					     <if test="day != null">
					     		 and s.day=#{day,jdbcType=OTHER}
					     </if>
			 			) AND a.source='00046' 
					GROUP BY  b.area_code,a.type
		    )a
	GROUP BY area_name,type
)data GROUP BY area_name
order by convert(area_name using gbk) asc;
  </select>
  <select id="antibioticTransfusionUse"    parameterType="com.huatuo.clinics.cms.bean.RuquestBeanDTO" resultType="com.huatuo.clinics.cms.db.bean.ReportResultDB">
select datas name, ifnull(CONCAT(CAST(sum(kss)/(sum(qty))*100 AS DECIMAL(8,1)),'%'),'0%') qty,sum(kss) ,(sum(qty)) from (
				select ifnull(CASE type WHEN '00046-0001'THEN qty END ,0) AS'kss',
			 	ifnull(CASE type WHEN '00046-0004'THEN qty END ,0) AS'qty',datas from  (
					SELECT a.type,SUM(a.qty) qty,
						CASE #{areaFlag,jdbcType=OTHER} WHEN '2' THEN  CONCAT(b.year) WHEN '1' THEN  CONCAT(b.month) ELSE CONCAT(b.day) END datas
						FROM sm_cli_area_cover_dtl a 
							RIGHT JOIN sm_cli_area_cover b
								ON (a.area_cover_id=b.area_cover_id)
									WHERE a.area_cover_id IN (
										SELECT area_cover_id FROM sm_cli_area_cover s WHERE s.parent_area_code=#{parentAreaCode,jdbcType=OTHER}
		  							 <if test="areaFlag == 2">
					     						 and s.year BETWEEN #{startYear,jdbcType=OTHER} AND #{endYear,jdbcType=OTHER} and s.area_flag=2 
					     				</if>
						 				<if test="areaFlag==1">
					     		 			 and s.year=#{year,jdbcType=OTHER} 	and s.month BETWEEN #{startMonth,jdbcType=OTHER} AND #{endMonth,jdbcType=OTHER} and s.area_flag=1
					     				</if>
					   				  <if test="areaFlag == 0">
					     					 and s.year=#{year,jdbcType=OTHER} and s.month=#{month,jdbcType=OTHER} and s.area_flag=0  and s.day BETWEEN #{startDay,jdbcType=OTHER} AND #{endDay,jdbcType=OTHER}
					    			 </if>
							)
						AND a.source='00046'
				GROUP BY  datas,type
			)data
	GROUP BY datas,type
)a GROUP BY datas
order by  cast(name as int)
  </select>
  <select id="TransfusionUseCg"   parameterType="com.huatuo.clinics.cms.bean.RuquestBeanDTO" resultType="com.huatuo.clinics.cms.db.bean.ReportResultDB">
select datas name,  ifnull(CONCAT(CAST(sum(kss)/(sum(qty))*100 AS DECIMAL(8,1)),'%'),'0%') qty,sum(kss) ,(sum(qty)) from (
				select ifnull(CASE type WHEN '00046-0002'THEN qty END ,0) AS'kss',
			 	ifnull(CASE type WHEN '00046-0004'THEN qty END ,0) AS'qty',datas from  (
					SELECT a.type,SUM(a.qty) qty,
						CASE #{areaFlag,jdbcType=OTHER} WHEN '2' THEN  CONCAT(b.year) WHEN '1' THEN  CONCAT(b.month) ELSE CONCAT(b.day) END datas
						FROM sm_cli_area_cover_dtl a 
							RIGHT JOIN sm_cli_area_cover b
								ON (a.area_cover_id=b.area_cover_id)
									WHERE a.area_cover_id IN (
										SELECT area_cover_id FROM sm_cli_area_cover s WHERE s.parent_area_code=#{parentAreaCode,jdbcType=OTHER}
		  							 <if test="areaFlag ==2">
					     						 and s.year BETWEEN #{startYear,jdbcType=OTHER} AND #{endYear,jdbcType=OTHER} and s.area_flag=2 
					     				</if>
						 				<if test="areaFlag == 1">
					     		 			 and s.year=#{year,jdbcType=OTHER} 	and s.month BETWEEN #{startMonth,jdbcType=OTHER} AND #{endMonth,jdbcType=OTHER} and s.area_flag=1
					     				</if>
					   				  	<if test="areaFlag == 0">
					     					 and s.year=#{year,jdbcType=OTHER} and s.month=#{month,jdbcType=OTHER} and s.area_flag=0  and s.day BETWEEN #{startDay,jdbcType=OTHER} AND #{endDay,jdbcType=OTHER}
					    			 	</if>
							)
						AND a.source='00046'
				GROUP BY  datas,type
			)data
	GROUP BY datas,type
)a GROUP BY datas
order by name+0
  </select> 
  <select id="RationalForm"   parameterType="com.huatuo.clinics.cms.bean.RuquestBeanDTO" resultType="com.huatuo.clinics.cms.db.bean.ReportResultDB">
  		SELECT a.area_name name,b.dict_item_name type,a.qty qty FROM (
			SELECT SUM(a.qty) qty,a.type,b.area_name
				FROM sm_cli_area_cover_dtl a 
					LEFT JOIN sm_cli_area_cover b
						ON(a.area_cover_id = b.area_cover_id)
								WHERE a.area_cover_id IN (
						SELECT s.area_cover_id  FROM sm_cli_area_cover s  WHERE s.parent_area_code=#{parentAreaCode,jdbcType=OTHER} and s.area_flag=#{areaFlag,jdbcType=OTHER}
						<if test="year != null">
					     		 and s.year=#{year,jdbcType=OTHER}
					     </if>
						 <if test="month != null">
					     		 and s.month=#{month,jdbcType=OTHER}
					     </if>
					     <if test="day != null">
					     		 and s.day=#{day,jdbcType=OTHER}
					     </if>
					) AND a.source='00046' 
					GROUP BY  b.area_code,a.type
		    )a LEFT JOIN 
		ss_dic_item b
	ON(a.TYPE=b.dict_item_value)
	order by convert(area_name using gbk) asc,type DESC
  </select>
  <select id="AreaGeneralSituation"  parameterType="com.huatuo.clinics.cms.bean.RuquestBeanDTO" resultType="com.huatuo.clinics.cms.db.bean.ReportResultDB">
  SELECT b.dict_item_name type,sum(a.qty) qty FROM (
		SELECT a.type,a.qty qty
				FROM sm_cli_area_cover_dtl a 
					LEFT JOIN sm_cli_area_cover b
						ON (a.area_cover_id=b.area_cover_id)
						WHERE a.area_cover_id IN (
						SELECT s.area_cover_id  FROM sm_cli_area_cover s  WHERE s.parent_area_code=#{parentAreaCode,jdbcType=OTHER} and s.area_flag=#{areaFlag,jdbcType=OTHER}
						<if test="year != null">
					     		 and s.year=#{year,jdbcType=OTHER}
					     </if>
						 <if test="month != null">
					     		 and s.month=#{month,jdbcType=OTHER}
					     </if>
					     <if test="day != null">
					     		 and s.day=#{day,jdbcType=OTHER}
					     </if>
					)
				AND a.source='00055'
			)a LEFT JOIN 
		ss_dic_item b
ON(a.TYPE=b.dict_item_value)
  </select>
  <select id="lowerRegion" parameterType="com.huatuo.clinics.cms.bean.RuquestBeanDTO" resultType="com.huatuo.clinics.cms.db.bean.ReportResultDB">
		SELECT CONCAT(a.qty,'%') qty,area_name name
				FROM sm_cli_area_cover_dtl a 
					LEFT JOIN sm_cli_area_cover b
						ON (a.area_cover_id=b.area_cover_id)
						WHERE a.area_cover_id IN (
						SELECT s.area_cover_id  FROM sm_cli_area_cover s  WHERE s.parent_area_code=#{parentAreaCode,jdbcType=OTHER} and s.area_flag=#{areaFlag,jdbcType=OTHER}
						<if test="year != null">
					     		 and s.year=#{year,jdbcType=OTHER}
					     </if>
						 <if test="month != null">
					     		 and s.month=#{month,jdbcType=OTHER}
					     </if>
					     <if test="day != null">
					     		 and s.day=#{day,jdbcType=OTHER}
					     </if>
					)
				AND a.source='00055'
			GROUP BY area_code
			order by convert(area_name using gbk) asc;
  </select>
  
  
  <select id="queryFirstTenTown" parameterType="java.util.Map" resultType="com.huatuo.clinics.cms.db.bean.ReportResultDB">
		select sum(a.qty) qty,b.sickness_name type,c.area_name name
				from sm_cli_area_cover_dtl a
				LEFT JOIN sm_cli_area_sickness_info b
				on(a.area_cover_id=b.area_cover_id and a.source= b.source)
				LEFT JOIN sm_cli_area_cover c
				on(a.area_cover_id=c.area_cover_id)
					<where>
								<if test="parentAreaCode != null">
					     		c.parent_area_code=#{parentAreaCode,jdbcType=OTHER}
					     		</if>
					     		<if test="reportType == 'year' ">
						     		and c.year=#{year,jdbcType=OTHER} and c.area_flag=2
						     	</if>
						     	<if test="reportType == 'quarter' ">
						     		and c.year=#{year,jdbcType=OTHER} 
						     		and c.month&gt;=#{startMonth,jdbcType=OTHER} 
						     		and c.month&lt;=#{endMonth,jdbcType=OTHER} 
						     		and c.area_flag=1
						     	</if>
						     	<if test="reportType == 'month' ">
						     		and c.year=#{year,jdbcType=OTHER} and c.month=#{startMonth,jdbcType=OTHER}
						     		and c.area_flag=1
						     	</if> 
						     	<if test="reportType == 'day' ">
						     		and c.year=#{year,jdbcType=OTHER}         and c.month=#{startMonth,jdbcType=OTHER}
						     		and c.day=#{day,jdbcType=OTHER}           and c.area_flag=0
						     	</if> 
		                and a.source IN('00068','00069','00070','00071','00072','00073','00074','00075','00076','00077')  
		            </where>            
				GROUP BY b.sickness_name,c.area_name
				ORDER BY name,qty DESC
  </select>
  
   <select id="queryFirstTenSum" parameterType="java.util.Map" resultType="com.huatuo.clinics.cms.db.bean.ReportResultDB">
  			select sum(a.qty) qty,b.sickness_name type,c.area_name name
				from sm_cli_area_cover_dtl a
				LEFT JOIN sm_cli_area_sickness_info b
				on(a.area_cover_id=b.area_cover_id and a.source= b.source)
				LEFT JOIN sm_cli_area_cover c
				on(a.area_cover_id=c.area_cover_id)
					<where>
								<if test="parentAreaCode != null">
					     		c.parent_area_code=#{parentAreaCode,jdbcType=OTHER}
					     		</if>
					     		<if test="reportType == 'year' ">
						     		and c.year=#{year,jdbcType=OTHER} and c.area_flag=2
						     	</if>
						     	<if test="reportType == 'quarter' ">
						     		and c.year=#{year,jdbcType=OTHER} 
						     		and c.month&gt;=#{startMonth,jdbcType=OTHER} 
						     		and c.month&lt;=#{endMonth,jdbcType=OTHER} 
						     		and c.area_flag=1
						     	</if>
						     	<if test="reportType == 'month' ">
						     		and c.year=#{year,jdbcType=OTHER} and c.month=#{startMonth,jdbcType=OTHER}
						     		and c.area_flag=1
						     	</if> 
						     	<if test="reportType == 'day' ">
						     		and c.year=#{year,jdbcType=OTHER}         and c.month=#{startMonth,jdbcType=OTHER}
						     		and c.day=#{day,jdbcType=OTHER}           and c.area_flag=0
						     	</if> 
		                and a.source IN('00068','00069','00070','00071','00072','00073','00074','00075','00076','00077')  
		            </where>            
				GROUP BY c.area_name
				ORDER BY name,qty DESC
  </select>
  
  
  <select id="queryFirstTentype" parameterType="java.util.Map" resultType="com.huatuo.clinics.cms.db.bean.ReportResultDB">
  			select sum(a.qty) qty,b.sickness_name name,c.dict_item_name type 
  			from sm_cli_area_cover_dtl a
				left join sm_cli_area_sickness_info b
				on(a.area_cover_id=b.area_cover_id and a.source= b.source)
				left join ss_dic_item c
				on(a.type=c.dict_item_value)
				left join sm_cli_area_cover s
				on(a.area_cover_id=s.area_cover_id)
				<where>
								<if test="parentAreaCode != null">
					     		s.area_code=#{parentAreaCode,jdbcType=OTHER}
					     		</if>
					     		<if test="reportType == 'year' ">
						     		and s.year=#{year,jdbcType=OTHER}
						     		and s.area_flag=2
						     	</if>
						     	<if test="reportType == 'quarter' ">

						     		and s.year=#{year,jdbcType=OTHER} 
						     		and s.month&gt;=#{startMonth,jdbcType=OTHER} 
						     		and s.month&lt;=#{endMonth,jdbcType=OTHER}
						     		and s.area_flag=1
						     	</if>
						     	<if test="reportType == 'month' ">
						     		and s.year=#{year,jdbcType=OTHER} and s.month=#{startMonth,jdbcType=OTHER}
						     		and s.area_flag=1
						     	</if>
						     	<if test="reportType == 'day' ">
						     		and s.year=#{year,jdbcType=OTHER}     and s.month=#{startMonth,jdbcType=OTHER}
						     		and s.day=#{day,jdbcType=OTHER}       and s.area_flag=0
						     	</if>
				and a.source IN('00068','00069','00070','00071','00072','00073','00074','00075','00076','00077')
				</where>
				group by a.source,a.type
  </select>
  
  <select id="queryFirstTentypes" parameterType="java.util.Map" resultType="com.huatuo.clinics.cms.db.bean.ReportResultDB">
  			select sum(a.qty) qty,b.sickness_name name,c.dict_item_name type 
  			from sm_cli_area_cover_dtl a
				left join sm_cli_area_sickness_info b
				on(a.area_cover_id=b.area_cover_id and a.source= b.source)
				left join ss_dic_item c
				on(a.type=c.dict_item_value)
				left join sm_cli_area_cover s
				on(a.area_cover_id=s.area_cover_id)
				<where>
								<if test="parentAreaCode != null">
					     		s.area_code=#{parentAreaCode,jdbcType=OTHER}
					     		</if>
					     		<if test="reportType == 'year' ">
						     		and s.year=#{year,jdbcType=OTHER}
						     		and s.area_flag=2
						     	</if>
						     	<if test="reportType == 'quarter' ">
						     		and s.year=#{year,jdbcType=OTHER} 
						     		and s.month&gt;=#{startMonth,jdbcType=OTHER} 
						     		and s.month&lt;=#{endMonth,jdbcType=OTHER}
						     		and s.area_flag=1
						     	</if>
						     	<if test="reportType == 'month' ">
						     		and s.year=#{year,jdbcType=OTHER} and s.month=#{startMonth,jdbcType=OTHER}
						     		and s.area_flag=1
						     	</if>
						     	<if test="reportType == 'day' ">
						     		and s.year=#{year,jdbcType=OTHER}     and s.month=#{startMonth,jdbcType=OTHER}
						     		and s.day=#{day,jdbcType=OTHER}       and s.area_flag=0
						     	</if>
				and a.source IN('00078','00079','00080','00081','00082','00083','00084','00085','00086','00087')
				</where>
				group by a.source,a.type
  </select>
  <select id="expire" parameterType="com.huatuo.clinics.cms.bean.RuquestBeanDTO" resultType="com.huatuo.clinics.cms.db.bean.ReportResultDB">
		  	SELECT
			sum(dtl.qty) qty
				FROM
					sm_cli_area_cover_dtl dtl
						right JOIN (
							select * from sm_cli_area_cover sm where sm.parent_area_code=#{parentAreaCode,jdbcType=OTHER} and sm.area_flag=#{areaFlag,jdbcType=OTHER}
						<if test="year != null">
					     		 and sm.year=#{year,jdbcType=OTHER}
					     </if>
						 <if test="month != null">
					     		 and sm.month=#{month,jdbcType=OTHER}
					     </if>
					     <if test="day != null">
					     		 and sm.day=#{day,jdbcType=OTHER}
					     </if>
					     )sm on (sm.area_cover_id=dtl.area_cover_id)
		where dtl.type='00054-0001'
  </select>
 <select id="listTimeClinics"  parameterType="com.huatuo.clinics.cms.bean.RuquestBeanDTO" resultType="HashMap">
 	select org_id org_id,org_credentials_time out_time from opm_org_extend_info where  opm_org_extend_info.org_credentials_time between   #{startTime,jdbcType=OTHER}  and  #{endTime,jdbcType=OTHER}
 </select>
  	
  
  <select id="queryGivenSummary" parameterType="java.util.Map" resultType="com.huatuo.clinics.cms.db.bean.ReportResultDB">
		  	select sum(a.qty) qty,b.sickness_name type  
		  	from sm_cli_area_cover_dtl a 
			left join sm_cli_area_sickness_info b
			on(a.area_cover_id=b.area_cover_id and a.source=b.source)
			<where> 
				a.area_cover_id in(
				select area_cover_id from 	sm_cli_area_cover s
				<where>
					<if test="parentAreaCode != null">
				     		s.area_code=#{parentAreaCode,jdbcType=OTHER}
				    </if>
				    <if test="reportType == 'year' ">
					     	and s.year=#{year,jdbcType=OTHER}
					     	and s.area_flag=2
					</if>
					<if test="reportType == 'quarter' ">
					     	and s.year=#{year,jdbcType=OTHER} 
					     	and s.month&gt;=#{startMonth,jdbcType=OTHER} 
					     	and s.month&lt;=#{endMonth,jdbcType=OTHER}
					     	and s.area_flag=1
					</if>
					<if test="reportType == 'month' ">
					     	and s.year=#{year,jdbcType=OTHER} and s.month=#{startMonth,jdbcType=OTHER}
					     	and s.area_flag=1
					</if>
					<if test="reportType == 'day' ">
					     	and s.year=#{year,jdbcType=OTHER} and s.month=#{startMonth,jdbcType=OTHER}
					     	and s.day=#{day,jdbcType=OTHER}
					     	and s.area_flag=0
					</if>
				</where> 
				)
			<if test="code != null">
                 and a.source=#{code,jdbcType=OTHER}
            </if>
            </where>
			group by a.source
  </select>	
 
  <select id="queryGivenFeatures" parameterType="java.util.Map" resultType="com.huatuo.clinics.cms.db.bean.ReportResultDB">
  			select sum(a.qty) qty,c.area_name name  
		  	from sm_cli_area_cover_dtl a 
			left join  sm_cli_area_cover c
			on(a.area_cover_id=c.area_cover_id)
			<where> 
					<if test="parentAreaCode != null">
				     		c.area_code=#{parentAreaCode,jdbcType=OTHER}
				    </if>
				    <if test="reportType == 'year' ">
					     	and c.year=#{year,jdbcType=OTHER}
					     	and c.area_flag=2
					</if>
					<if test="reportType == 'quarter' ">
					     	and c.year=#{year,jdbcType=OTHER} 
					     	and c.month&gt;=#{startMonth,jdbcType=OTHER} 
					     	and c.month&lt;=#{endMonth,jdbcType=OTHER}
					     	and c.area_flag=1
					</if>
					<if test="reportType == 'month' ">
					     	and c.year=#{year,jdbcType=OTHER} and c.month=#{startMonth,jdbcType=OTHER}
					     	and c.area_flag=1
					</if>
					<if test="reportType == 'day' ">
					     	and c.year=#{year,jdbcType=OTHER} and c.month=#{startMonth,jdbcType=OTHER}
					     	and c.day=#{day,jdbcType=OTHER}
					     	and c.area_flag=0
					</if>
			<if test="code != null">
                 and a.source=#{code,jdbcType=OTHER}
            </if>
            </where>
			group by c.area_name
			ORDER BY CONVERT(name USING gbk) ASC
  </select>
  
  <select id="queryGivenSexOrAge" parameterType="java.util.Map" resultType="com.huatuo.clinics.cms.db.bean.ReportResultDB">
  			select sum(a.qty) qty,b.sickness_name name, c.dict_item_name type
		  	from sm_cli_area_cover_dtl a 
			left join  sm_cli_area_sickness_info b
			on(a.area_cover_id=b.area_cover_id and a.source=b.source)
			left join ss_dic_item c
			on(a.type=c.dict_item_value)
			left join  sm_cli_area_cover d
			on(d.area_cover_id=a.area_cover_id)
			<where> 
					<if test="parentAreaCode != null">
				     		d.area_code=#{parentAreaCode,jdbcType=OTHER}
				    </if>
				    <if test="reportType == 'year' ">
					     	and d.year=#{year,jdbcType=OTHER}
					     	and d.area_flag=2
					</if>
					<if test="reportType == 'quarter' ">
					     	and d.year=#{year,jdbcType=OTHER} 
					     	and d.month&gt;=#{startMonth,jdbcType=OTHER} 
					     	and d.month&lt;=#{endMonth,jdbcType=OTHER}
					     	and d.area_flag=1
					</if>
					<if test="reportType == 'month' ">
					     	and d.year=#{year,jdbcType=OTHER} and d.month=#{startMonth,jdbcType=OTHER}
					     	and d.area_flag=1
					</if>
					<if test="reportType == 'day' ">
					     	and d.year=#{year,jdbcType=OTHER} and d.month=#{startMonth,jdbcType=OTHER}
					     	and d.day=#{day,jdbcType=OTHER}
					     	and d.area_flag=0
					</if>
			<if test="code != null">
                 and a.source=#{code,jdbcType=OTHER}
            </if>
            </where>
			group by a.type
  </select>
  
  <select id="queryGivenTimeTrend" parameterType="java.util.Map" resultType="com.huatuo.clinics.cms.db.bean.ReportResultDB">
  	select  sum(a.qty) qty,(case #{reportType,jdbcType=OTHER} when 'year' then b.year when 'month' then b.month else b.day end) as  name  
  	from sm_cli_area_cover_dtl a 
		left join sm_cli_area_cover b
		on(a.area_cover_id=b.area_cover_id)
		<where> 
					<if test="parentAreaCode != null">
				     		b.area_code=#{parentAreaCode,jdbcType=OTHER}
				    </if>
				    <if test="reportType == 'year' ">
					     	and b.year&gt;=#{startYear,jdbcType=OTHER} and b.year&lt;=#{endYear,jdbcType=OTHER}    
					     	and b.area_flag=2
					</if>
					<if test="reportType == 'month' ">
					     	and b.year=#{startYear,jdbcType=OTHER} and b.month &gt;=#{startMonth,jdbcType=OTHER}
					     	and b.month &lt;=#{endMonth,jdbcType=OTHER}
					     	and b.area_flag=1
					</if>
					<if test="reportType == 'day' ">
					     	and b.year=#{startYear,jdbcType=OTHER} and b.month=#{startMonth,jdbcType=OTHER}
					     	and b.day &gt;=#{startDay,jdbcType=OTHER} and b.day &lt;=#{endDay,jdbcType=OTHER}
					     	and b.area_flag=0
					</if>
		<if test="code != null">
             and a.source=#{code,jdbcType=OTHER}
        </if>
		</where>
		group by (case #{reportType,jdbcType=OTHER} when 'year' then b.year when 'month' then b.month else b.day end) 
  </select>
  
  <!-- 个体诊所医疗质量情况概览 -->
  <select id="OverviewClinicMedicalQuality" parameterType="com.huatuo.clinics.cms.bean.RuquestBeanDTO" resultType="com.huatuo.clinics.cms.db.bean.ReportResultDB">
  	select sum(qty) qty,
			case type when '00046-0001' then '抗生素处方数量'
  				when '00046-0002' then '输液处方数量' 
  				when '00046-0004' then '处方总量' 
 				 when '00054-0001' then '诊所执业许可证到期数量' 
					end as "type"
						from sm_cli_area_cover_dtl dtl RIGHT JOIN(
							select * from sm_cli_area_cover sm where sm.parent_area_code=#{parentAreaCode,jdbcType=OTHER} and sm.area_flag=#{areaFlag,jdbcType=OTHER}
						<if test="year != null">
					     		 and sm.year=#{year,jdbcType=OTHER}
					     </if>
						 <if test="month != null">
					     		 and sm.month=#{month,jdbcType=OTHER}
					     </if>
					     <if test="day != null">
					     		 and sm.day=#{day,jdbcType=OTHER}
					     </if>
					      )sm on (sm.area_cover_id=dtl.area_cover_id)
						where  dtl.type in('00046-0001','00046-0002','00046-0004','00054-0001')
				GROUP by type
UNION
SELECT 0 AS qty,'医疗事故统计' AS NAME  
UNION
SELECT 100 AS qty,'电子病历合格率' AS NAME  
<!--   	select ROUND(avg(qty),0) qty, -->
<!-- 			case type when '00055-0002' then '电子病历合格率'  -->
<!-- 					end as "type" -->
<!-- 						from sm_cli_area_cover_dtl dtl RIGHT JOIN( -->
<!-- 							select * from sm_cli_area_cover sm where sm.parent_area_code=#{parentAreaCode,jdbcType=OTHER} and sm.area_flag=#{areaFlag,jdbcType=OTHER} -->
<!-- 						<if test="year != null"> -->
<!-- 					     		 and sm.year=#{year,jdbcType=OTHER} -->
<!-- 					     </if> -->
<!-- 						 <if test="month != null"> -->
<!-- 					     		 and sm.month=#{month,jdbcType=OTHER} -->
<!-- 					     </if> -->
<!-- 					     <if test="day != null"> -->
<!-- 					     		 and sm.day=#{day,jdbcType=OTHER} -->
<!-- 					     </if> -->
<!-- 					     )sm on (sm.area_cover_id=dtl.area_cover_id) -->
<!-- 						where  dtl.type in('00055-0002') -->
<!-- 				GROUP by type -->
UNION
SELECT 100 AS qty,'服务满意度' AS NAME  
UNION
SELECT 100 AS qty,'电子处方合格率' AS NAME 
  </select>
   <select id="ListOverviewClinicMedicalQuality" parameterType="com.huatuo.clinics.cms.bean.RuquestBeanDTO" resultType="HashMap">
select name,
	MAX(case type when '00046-0001' then qty END)'antibioticRecipeTotal',
	MAX(case type when '00046-0002' then qty END) 'infusionRecipeTotal',
	MAX(case type when '00046-0004' then qty END) 'recipeTotal',
	100 AS 'caseFPY',
	0 AS 'malaPraxisTotal',
	100 AS 'serviceSatisfaction',
	100 AS 'recipeFPY'
 		from (select area_name name,type,qty
			from sm_cli_area_cover_dtl dtl RIGHT JOIN(
				select * from sm_cli_area_cover sm where sm.parent_area_code=#{parentAreaCode,jdbcType=OTHER} and sm.area_flag=${areaFlag}
						<if test="year != null">
					     		 and sm.year=#{year,jdbcType=OTHER}
					     </if>
						 <if test="month != null">
					     		 and sm.month=#{month,jdbcType=OTHER}
					     </if>
					     <if test="day != null">
					     		 and sm.day=#{day,jdbcType=OTHER}
					     </if>
					      )sm on (sm.area_cover_id=dtl.area_cover_id)
					where  dtl.type in('00046-0001','00046-0002','00046-0004','00054-0001','00055-0002')
			GROUP by sm.area_name,type)data
	GROUP by name
	order by convert(name using gbk) asc;
  </select>
  <select id="CoverageJson" parameterType="com.huatuo.clinics.cms.bean.RuquestBeanDTO" resultMap="BaseResultMap">
<!--   		select CONCAT(CAST(sum(doctor_qty)/sum(nurse_qty) AS DECIMAL(8,1)),':1') area_code,sum(clinic_qty) clinic_qty,sum(doctor_qty) doctor_qty,sum(nurse_qty) nurse_qty,area_name from sm_cli_area_cover s -->
<!--   				 WHERE s.parent_area_code=#{parentAreaCode,jdbcType=OTHER} -->
<!--   				 <if test="year != null"> -->
<!-- 				     		and s.year &lt;=#{year,jdbcType=OTHER} -->
<!-- 				     	</if> -->
<!-- GROUP BY area_code -->
		SELECT * FROM sm_cli_area_cover s 
		<where>
		s.parent_area_code=#{parentAreaCode,jdbcType=OTHER} 
		and s.area_flag = ${areaFlag}
									and s.`year` = #{year,jdbcType=OTHER}
									<if test="month != null">
									and s.`month` =#{month,jdbcType=OTHER}
									</if>
		</where>
  </select>
  
 <select id="queryOperates" parameterType="java.util.Map" resultType="com.huatuo.clinics.cms.db.bean.ReportResultDB">
  			select d.area_name name, b.dict_item_name type,sum(a.qty) qty
		from sm_cli_area_cover_dtl a
		left join ss_dic_item b 
		on(a.type=b.dict_item_value)
		left join sm_cli_area_cover d 
		on(a.area_cover_id=d.area_cover_id)
		<where> 
                <if test="parentAreaCode != null">
				     d.parent_area_code=#{parentAreaCode,jdbcType=OTHER}
				</if>
				<if test="reportType == 'month' ">
				     and d.year=#{year,jdbcType=OTHER} and d.month=#{month,jdbcType=OTHER}   and d.area_flag=1
				 </if>
				 <if test="reportType == 'year' ">
				     and d.year=#{year,jdbcType=OTHER}    and d.area_flag=2
				 </if>
				     and a.source='00049' 
               <if test="sourceCode != null">
					and a.type=#{sourceCode,jdbcType=OTHER}
				</if>
        </where>                      
               group by d.area_name
               ORDER BY CONVERT(name USING gbk) ASC
  </select>
  
  
  
  
</mapper>